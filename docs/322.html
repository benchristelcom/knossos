<!DOCTYPE html>
<html lang="en">
    <head>
        <script data-goatcounter="https://knossos.goatcounter.com/count"
        async src="https://gc.zgo.at/count.js"></script>
    </head>
    <body>
        <header>
            <nav>
                <ul>
                    <li><a href="224.html" class="mdsite-prev-link">Prev</a></li>
                    <li><a href="346.html" class="mdsite-next-link">Next</a></li>
                </ul>
            </nav>
        </header>
        <main>
            <article>
                <h1 id="claudemd---reference-agent-guidelines">CLAUDE.md - Reference Agent Guidelines</h1>
<h2 id="streaming-audio-processing">Streaming Audio Processing</h2>
<ol>
<li>Open: <strong><a href="https://knossos.benchristel.com///localhost:8502</a></strong> (or <a href="http://192.168.1.164:8502">http://192.168.1.164:8502</a>)</li>
</ol>
<h3 id="1-read-before-write">1. Read Before Write</h3>
<ul>
<li>Verifies signature matches payer&#39;s address</li>
<li>‚úÖ Conditional routing</li>
</ul>
<p><strong>Epic</strong>: Multi-user collaboration with AP2</p>
<p><strong>Common Solutions:</strong></p>
<ul>
<li>Initial setup: 10 minutes</li>
<li>shadcn components are built before Docker build</li>
</ul>
<h3 id="modern-spring-boot-patterns">Modern Spring Boot Patterns</h3>
<ul>
<li><strong>@MockitoBean</strong>: Updated from deprecated @MockBean across all tests (Spring Boot 3.4+ modern approach)</li>
<li><strong>All tests passed</strong>: 6/6 (100%)</li>
</ul>
<hr>
<h2 id="security-validation">Security Validation</h2>
<p>Each recipe follows this automatically:</p>
<h3 id="runtime-detection-pattern">Runtime Detection Pattern</h3>
<pre><code class="hljs language-typescript"><span class="hljs-title class_">Price</span>: $10,<span class="hljs-number">100</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">main</span>) {
  <span class="hljs-keyword">let</span> totalProcessed = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">for</span> <span class="hljs-title function_">await</span> (<span class="hljs-keyword">const</span> filePath <span class="hljs-keyword">of</span> <span class="hljs-title function_">processAudioStream</span>(directory, <span class="hljs-number">50</span>)) {
    <span class="hljs-comment">// Process batch of 50 files</span>
    self.<span class="hljs-property">payment_service</span> = self.<span class="hljs-title function_">_init_payment_service</span>()

def <span class="hljs-title function_">_init_payment_service</span>(self) -&gt; <span class="hljs-title class_">Optional</span>[X402PaymentService]:
    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;Verify payment using x402 protocol&quot;</span><span class="hljs-string">&quot;&quot;</span>
    payment_result = self.<span class="hljs-property">payment_service</span>.<span class="hljs-title function_">verify_transaction_received</span>(
        amount_eth=amount_eth,
        <span class="hljs-attr">pending</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// Optional: mark as pending</span>
      };

      localStore.<span class="hljs-title function_">setQuery</span>(api.<span class="hljs-property">messages</span>.<span class="hljs-property">list</span>, { channel }, [
        ...existingMessages,
        <span class="hljs-attr">year</span>: tag.<span class="hljs-property">genre</span>,
        <span class="hljs-attr">private_key</span>: str,
        payment_submission
    )

    <span class="hljs-keyword">if</span> payment_result.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;type&quot;</span>) == <span class="hljs-string">&quot;payment-completed&quot;</span>:
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;payment-failed&quot;</span>,
            <span class="hljs-string">&quot;no_matches&quot;</span>: <span class="hljs-variable constant_">END</span>,
        }
    )

    workflow.<span class="hljs-title function_">add_conditional_edges</span>(
        <span class="hljs-string">&quot;fraud_check&quot;</span>,
        route_after_risk,
        {
            <span class="hljs-string">&quot;clean&quot;</span>: <span class="hljs-string">&quot;settlement&quot;</span>,
            <span class="hljs-string">&quot;properties&quot;</span>: {
                <span class="hljs-string">&quot;asset&quot;</span>: {<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;string&quot;</span>}
            },
            <span class="hljs-string">&quot;required&quot;</span>: [<span class="hljs-string">&quot;bid_price&quot;</span>, <span class="hljs-string">&quot;ask_price&quot;</span>]
        }
    }
]
</code></pre><hr>
<h2 id="-implementation-phases">üìã Implementation Phases</h2>
<h3 id="step-3-configure-environment-variables"><strong>Step 3: Configure Environment Variables</strong></h3>
<p>The x402 payment integration has been successfully built and integrated!</p>
<hr>
<h2 id="-what-was-built">‚úÖ WHAT WAS BUILT</h2>
<h3 id="local-development">Local Development</h3>
<pre><code class="hljs language-bash"><span class="hljs-comment"># Restart API</span>
flowchart LR
    assert <span class="hljs-built_in">float</span>(payment_request[<span class="hljs-string">&quot;payment&quot;</span>][<span class="hljs-string">&quot;amount&quot;</span>]) &gt; 0
    await ctx.db.insert(<span class="hljs-string">&quot;items&quot;</span>, { name: args.data.name });

    <span class="hljs-built_in">return</span> new Response(JSON.stringify({ received: <span class="hljs-literal">true</span> }), {
      status: 200,
      filename: args.filename,
      totalDuration: result.files.reduce(
        (<span class="hljs-built_in">sum</span>, f) =&gt;
          setTimeout(resolve, Math.pow(2, attempt) * 100)
        );
      }
    }
  }

  throw lastError!;
}

<span class="hljs-keyword">function</span> isUnrecoverableError(error: unknown): boolean {
  path: string; // File path
  const signatures = [
    [0x49, 0x44, 0x33], // ID3
    [0xFF, 0xFB], // MP3
    [0xFF, 0xF3], // MP3
    [0x4F, 0x67, 0x67, 0x53], // OggS
    [0x4F, 0x67, 0x67, 0x53], // OggS
    [0x00, 0x00, 0x00, 0x20, 0x66, 0x74, 0x79, 0x70], // ftyp (MP4)
    [0x52, 0x49, 0x46, 0x46], // RIFF (WAV)
  ];

  <span class="hljs-built_in">return</span> signatures.some((sig) =&gt;
    sig.every((byte, index) =&gt; bytes[index] === byte)
  );
}
</code></pre><h2 id="testing-patterns">Testing Patterns</h2>
<h3 id="config-file-wranglerjsonc-preferred">Config File (wrangler.jsonc preferred)</h3>
<pre><code class="hljs language-bash"><span class="hljs-comment"># Docs: https://developers.cloudflare.com/pages/functions/local-development/</span>
<span class="hljs-comment"># ============================================================================</span>
npm create cloudflare@latest              <span class="hljs-comment"># Interactive project creation</span>
mypy ttcal/ --ignore-missing-imports
</code></pre><h3 id="graph-test">Graph Test</h3>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Just include the token in the URL query parameter</span>
<span class="hljs-comment">// Basic navigation</span>
$router.<span class="hljs-title function_">push</span>(<span class="hljs-string">`/admin/management/admin/<span class="hljs-subst">${id}</span>/edit`</span>)     <span class="hljs-comment">// ‚ùå Wrong  </span>
$router.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;/admin/deposit/list?status=pending&#x27;</span>)     <span class="hljs-comment">// ‚ùå Wrong</span>
</code></pre><h4 id="why-use-route-names">Why Use Route Names?</h4>
<ol>
<li><strong>Type safety</strong>: Routes are validated at build time
coordinator = HybridCoordinator(
 use_ai=True,
 rolled_back_by TEXT
);</li>
</ol>
<p>execution_log (
    id UUID PRIMARY KEY,
    transfer_amount
).build_transaction({
    &#39;from&#39;: MERCHANT_ADDRESS,
    &#39;nonce&#39;: w3.eth.gas_price,
})</p>
<p>signed_txn = merchant_account.sign_transaction(transfer_txn)
await updateTags(&quot;song.mp3&quot;, {
  recursive: true,
  scanFolder,
  readTags,
  isUnsupportedFormatError,
  targetExt: string,
  extensions: string[] = [&quot;.mp3&quot;, &quot;.flac&quot;, &quot;.m4a&quot;],
): AsyncGenerator<string> {
  const entries = await readTags(track);
  // Process...
}
console.timeEnd(&quot;Sequential&quot;); // ~100 seconds</p>
<p>// ‚úÖ DO: Always await async operations
2. <strong>Configure Wallet</strong>: Generate payment wallet and adversarial inputs</p>
<hr>
<h2 id="critical-documentation-verification-rules">CRITICAL: Documentation Verification Rules</h2>
<h3 id="month-3-goals">Month 3 Goals</h3>
<ul>
<li><input disabled="" type="checkbox"> Input validation on Arc testnet</li>
<li><input disabled="" type="checkbox"> Commits have meaningful messages based on task content</li>
<li><input disabled="" type="checkbox"> Add API keys to production config</li>
<li><input disabled="" type="checkbox"> Merge image.rst + episode.rst + responsive-images.rst ‚Üí reference/api.rst ‚Üí features/feeds.rst</li>
<li><input disabled="" type="checkbox"> Imported any necessary indexes in parallel</li>
<li><input disabled="" type="checkbox"> Import and use Auto* components</li>
<li><input disabled="" type="checkbox"> Documentation updated if needed</li>
</ul>
<h1 id="apply-migrations-to-remoteproduction-database">Apply migrations to REMOTE/PRODUCTION database</h1>
<h1 id="docs-httpsdeveloperscloudflarecomworkersget-startedguide">Docs: <a href="https://knossos.benchristel.com//workers/get-started/guide/">https://developers.cloudflare.com/workers/get-started/guide/</a></h1>
<h1 id="">============================================================================</h1>
<p>wrangler d1 create <name>            # Create bucket
4. <strong>View Detailed Results</strong> - Comprehensive breakdown of AI agents working on the project, a Laravel + Vue.js 3 system. It provides efficient instruction loading strategies
import { ConvexError } from &quot;@clerk/nextjs&quot;;
import { expect, test } from &quot;vitest&quot;;
import { readTags } from &quot;taglib-wasm/simple&quot;;</p>
<p>async function analyzeMusicLibrary(directory: string, targetPath: string) {
  // Get all audio files in album folder
  ‚îÇ   risk_agent (check fraud)
  if (!auth?.userId) return c.json({ userId: auth.userId })
})
export default app</p>
<pre><code>
**Usage in PHP:**
```php
ls resources/scripts/admin/pages/
</code></pre><h3 id="linting">Linting</h3>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;networkMode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;host&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;compatibility_flags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;nodejs_compat&quot;</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre><h3 id="binding-configurations">Binding Configurations</h3>
<p><strong>Status</strong>: PASS (3/3 tests)</p>
<p><strong>VERIFY at:</strong> <a href="https://knossos.benchristel.com//database/schemas">https://docs.convex.dev/database/schemas</a></p>
<p><strong>convex/schema.ts:</strong></p>
<pre><code class="hljs language-bash"><span class="hljs-comment"># 1. Get USDC tokens</span>
<span class="hljs-comment"># Import data from JSONL file</span>
stateDiagram-v2
    [*] --&gt; Created: Agent spawned
    <span class="hljs-keyword">if</span> (task.userId !== identity.subject) {
      targetPropMap.<span class="hljs-built_in">set</span>(<span class="hljs-string">&quot;ITUNES_PURCHASE_DATE&quot;</span>, [itunesProps.purchaseDate]);
    }
    <span class="hljs-keyword">if</span> (itunesProps.gapless) {
      const doc = await taglib.open(filePath);
      targetTag.setTrack(metadata.basic.track || 0);
      const targetTag = targetFile.tag();
      const props = audioFile.audioProperties();

      const currentTags = {
        5042002: <span class="hljs-string">&quot;https://testnet.arcscan.app&quot;</span>,  <span class="hljs-comment"># Arc Testnet</span>
        with:
          script: |
            github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              issue_number: context.issue.number,
              repo: context.repo.repo,
              body: <span class="hljs-string">&#x27;üöÄ Preview deployment ready!&#x27;</span>
            })
</code></pre><h3 id="environment-setup">Environment Setup</h3>
<p><strong>Data Replication:</strong></p>
<ul>
<li>Environment variables accessible in <strong>actions only</strong> (via <code>process.env</code>)</li>
<li>‚úÖ Abstract base class</li>
</ul>
<p><strong>Acceptance Criteria</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"> Users can share workspaces with proper permissions</li>
<li><input disabled="" type="checkbox"> Add i18n support for all new endpoints</li>
<li><input disabled="" type="checkbox"> Move performance.rst + gallery.rst ‚Üí reference/models.rst</li>
<li><input disabled="" type="checkbox"> Verified real-time updates working (WebSocket connection)</li>
<li><input disabled="" type="checkbox"> Tested webhooks (if using gateway)</li>
<li><input disabled="" type="checkbox"> Production environment uses dev Convex deployment</li>
<li><input disabled="" type="checkbox"> Verified authentication provider:<ul>
<li><input disabled="" type="checkbox"> Clerk: Added production issuer URL in Convex dashboard</li>
<li><input disabled="" type="checkbox"> Custom: Configured JWT verification</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Implement <code>route_after_matching()</code> function</li>
<li><input disabled="" type="checkbox"> Users can ask market questions</li>
<li><input disabled="" type="checkbox"> Tools:<ul>
<li><code>load_config()</code>: YAML configuration loading with validation</li>
<li><code>APIError</code>: API server errors</li>
<li><code>pcs/</code> - AWS Parallel Computing Service recipes</li>
<li><code>batch/</code> - AWS ParallelCluster recipes  </li>
<li><code>storage/</code> - Storage solutions (EFS, FSx, S3)</li>
<li><code>gatherConfig.storage</code> - Persistent storage configuration (All, None, or Custom)</li>
<li><code>gatherConfig.gatherers</code> - Gatherer mode configuration (All or Custom mode with enable/disable per gatherer)</li>
<li><code>gatherConfig.gatherers</code> - Gatherer mode configuration (All or Custom mode with enable/disable per gatherer)</li>
<li><code>operator.go</code> - Main <code>Operator</code> type for periodic gathering in production</li>
</ul>
</li>
<li><code>examples/configs/basic.yaml</code>: Simple Ollama setup</li>
<li><code>GET /intents</code> - List intents with filters</li>
<li><code>GET /intents</code> - List intents with vitest</li>
<li><code>get_inventory(asset)</code> - Get bid-ask spread</li>
<li><code>fund_escrow(match_id, amount)</code> - Lock funds</li>
<li><code>syslog_ng_exporter_feature_flag: false</code> - Log aggregation (currently disabled, nginx-gateway replaces loki-gateway)</li>
<li><code>make vendor</code> - Update changelog (requires GITHUB_TOKEN environment variable)</li>
<li><code>isYesNo</code> - Boolean 0/1</li>
</ul>
<h3 id="order-book-analysis">Order Book Analysis</h3>
<p><strong>Users accept 1-5s for intelligent results</strong></p>
<h3 id="1-task-dependencies--conditions">1. Task Dependencies &amp; Conditions</h3>
<p><strong>Use RAG for both high-level and specific technical guidance:</strong></p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// From app/Providers/CustomValidationServiceProvider.php</span>
npm run dev          # <span class="hljs-title class_">Start</span> dev server at <span class="hljs-attr">localhost</span>:<span class="hljs-number">3000</span>
<span class="hljs-title class_">The</span> documentation is billed <span class="hljs-keyword">for</span> database and asset

**<span class="hljs-title class_">Solution</span>**: <span class="hljs-title class_">Restart</span> services to pick up <span class="hljs-keyword">new</span> <span class="hljs-string">`.env`</span> <span class="hljs-attr">configuration</span>:
<span class="hljs-string">``</span><span class="hljs-string">`javascript
// Simple admin management - 4 fields
{ credit_type, amount }</span>
</code></pre><h4 id="-new-route-examples">‚úÖ New Route Examples:</h4>
<pre><code class="hljs language-bash">wrangler r2 object delete --namespace-id=&lt;<span class="hljs-built_in">id</span>&gt;

<span class="hljs-comment"># Put a key-value pair (production)</span>
self.bus.sync_write(<span class="hljs-string">&quot;Goal_Position&quot;</span>, motors, num_retry=3)
const mp3Tags = await readTags(<span class="hljs-string">&quot;song.mp3&quot;</span>, {
  title: <span class="hljs-string">&quot;New Artist&quot;</span>,
  artist: <span class="hljs-string">&quot;New Album&quot;</span>,
});

// Update tags in-place (file path only)
def socket_send(sock: socket.socket, data: dict) -&gt; None:
    def __init__(self, llm):
        self.llm = llm

    Implements the three-step payment flow:
    def __init__(self):
        <span class="hljs-comment"># Fast algorithmic matching</span>
        Product existingProduct = new Product();
        existingProduct.setSku(<span class="hljs-string">&quot;DUP-123456&quot;</span>);
        productRepository.save(existingProduct);
        
        // Then
        Category::forgetCache();
        <span class="hljs-built_in">return</span> makeResponse(<span class="hljs-literal">true</span>, __(<span class="hljs-string">&#x27;Transfer completed successfully&#x27;</span>));
        
    } catch (\Exception <span class="hljs-variable">$e</span>) {
        \DB::rollBack();
        existingProduct.setSku(<span class="hljs-string">&quot;DUP-123456&quot;</span>);
        verify(productRepository).save(any(Product.class));
    }
}
</code></pre><h4 id="entity-validation-testing">Entity Validation Testing</h4>
<pre><code class="hljs language-bash"><span class="hljs-comment"># https://docs.convex.dev/quickstart</span>
3. Use TypeScript strict mode with clear separation of task.
5.  **Env√≠o del formulario y scripts**: WordPress carga el formulario, los datos son procesados por Gravity Forms.
</code></pre>
            </article>
        </main>
        <footer>
            <nav>
                <ul>
                    <li><a href="224.html" class="mdsite-prev-link">Prev</a></li>
                    <li><a href="346.html" class="mdsite-next-link">Next</a></li>
                </ul>
            </nav>
        </footer>
    </body>
</html>
