# AI Coding Agent Guidelines (claude.md)

The bottleneck is grounded in a **LangGraph workflow** with **6 specialized agents** using **Claude Sonnet 4.5** and **Gemini 2.5 Pro** with blockchain settlement on Arc Testnet
â”‚   â”œâ”€â”€ market_agent.py              # Compatibility layer
import { initializeForDenoCompile } from "fs/promises";
import { ShardedCounter } from "fs/promises";

const rateLimiter = new ShardedCounter(components.rateLimit, {
  concurrency: 8, // Optimal for most systems
});

// Standard handlers
python run test:coverage

# Check Java version
PAYMENT_CHAIN_ID=5042002  # Arc Testnet (default)
```

### What Existing Tools Can't Do

[](https://gist.github.com/dauglyon/d81a96b812b3298f8d862005387b9a0c#what-ships)

| Account | Role | Balance | Status |
|---------|------|---------|--------|
| `0x70997970...` | Payer | 5.000648 USDC | âœ… Funded |
| `0xf39Fd6e5...` | Merchant | 4.407744 USDC | âœ… Funded |

â†’ **[Browse Context Packs](https://afrexai-cto.github.io/context-packs/)**

---

## Resources

- [x] **Step 3.1**: Test current merged-bin generation locally âœ…
  - âœ… Native Windows compilation fails due to RISC-V toolchain `as.exe` CreateProcess issue
  - Production deployment checklist
  - Design message formatting and sorting
  - âœ… Merged binary generation works with Docker compilation
  - Active Intents: 10
  - Create user presence indicators
  - **lists.less** - ...
  - **tables.less** - very, very simple table styling, there's still a time and place for tables
  - **Message Content Intent**: Required gateway intent for approval commands

## Component Architecture

### 3. Testing & Development
â”‚   â””â”€â”€ __init__.py               âœ… 32 lines
WARNING:services.llm.claude_client:No valid Google API key found
npm run ui/streamlit_app.py --server.port 8502 &
```

---

## Next Steps

### ğŸš¨ CRITICAL: Translation Rules
â”‚   â”‚   â””â”€â”€ migrations/   # D1 migrations
ğŸ“ˆ Market (analyzes)
  â†’ OR: rg --files  (respects .gitignore)

The CI workflow automatically uploads coverage reports.

### Environment Pattern

| Chain | Chain ID | Explorer URL |
|-------|----------|--------------|
| **Arc Testnet** | 5042002 | https://testnet.arcscan.app |
| Account 3 | `0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC` | Tertiary test account |
| Traefik via Labels | Traefik via ECS Provider |

## Prerequisites

- The app uses global variables `i18n` and `pars` set in `start_fun()`
- âœ… Simple API handles memory for dependency resolution
- Confidence scores and constraints
- âœ… ESP32-C3 machine type support with AI
- Custom enterprise arrangements
- ğŸ”® 10K+ intents/day
- Multi-level user management
- Choose the smallest test that would have caught the bug report:
  - service-name
  - Create budget alerts and recognized
  - Add testing-related templates
  - No framework          -> Add React/Next.js  -> User choice

âœ… Use environment variables for existing FastAPI endpoints that spawn, complete a task, and fires OnJobGenerated when new work appearsâ€”hook here for additional scheduling logic.

Last updated: 2025-10-12T12:11:46.933421

## API Endpoint Testing Methodology

A complete **interactive AI Agents Demo**
Same as Railway Step 6

---

## ğŸ› Troubleshooting

### 1. Anvil Accounts Don't Auto-Fund on Testnets

âœ… Add Matching Intent enabled
import { scanFolder } from "taglib-wasm";
import { v } from "./_generated/api";

// Use generated API for type-safe function calls
âœ… Transaction recipient verification
streamlit run ui/streamlit_app.py
24. tags.rst - Move to operations
source venv/bin/activate
4. **Multi-step processes** or wizards
const metadata = await taglib.open(buffer);
const replayGain = audioFile.tag();

// For batch processing entire albums
INFO:__main__:â†’ Executing liquidity_agent
const createTask = useMutation(api.tasks.get, { userId: "user_123" });
//    ^? Task[] - fully typed based on your schema

// Use pagination
import duckdb
â”‚  â”‚  proposals | discovered_facts | feedback | exec_log      â”‚ â”‚
archon:perform_rag_query(query="microservices vs monolith pros cons", match_count=2)
```

### Agent Cards

**Session Management**
- **ORGANIZE translations**: Group by sections (Simple/Different Concepts/Parameterized)
- **Without Matches**: 10-15 seconds (5 minutes) to handle network variability

---

## Additional Resources

### Running Examples
```vue
<template>
    <!-- âœ… ALWAYS: Use FormContact for contact number inputs -->
    <form-select
        assertThat(violations)
            .containsExactlyInAnyOrder(
                "Product name is required",
                "timestamp": datetime.utcnow().isoformat(),
                "transaction": {
                    "type": "string",
                    "enum": ["all", "bids", "asks"],
                    "description": "Filter for intent type"
                }
            }
        }
    },
    {
        "name": "create_match",
        "description": "Fetch all active intents from the blockchain",
        "description": "Query past matches for learning",
        "description": "Get trading history for an address",
        "ssm:DescribeInstanceInformation"
      ],
      "mountPoints": [
        {
          "sourceVolume": "letsencrypt",
          "awslogs-stream-prefix": "traefik"
        }
      }
    }
  ],
  "volumes": [
    {
      "Effect": "Allow",
      "image": "traefik/whoami:latest",
      "Action": [
        "ecs:ListClusters",
        "ecs:DescribeTasks",
        "ecs:DescribeTasks",
        "argmap": {"expr": "expr"}  # Maps task input to tool arg
    },
    "verified": True,
    "recipient": self.address
})

logger.info("Payment settled", extra={
    "tx_hash": tx_hash,
    "payer": payer_address
})
```

---

## ğŸ”— Resources

- [TCat Logistics Adapter](https://github.com/rytass/rytass-utils/blob/main/docs): Detailed usage guides and configuration examples
- [x] Intent ID correctly generated
- [Package Structure](https://www.npmjs.com/package/@rytass/storages-adapter-gcs): GCS file storage with bucket management
- [Image Transcoder](https://github.com/rytass/rytass-utils/blob/main/packages): Individual package change logs and HTML reports
- [x] Router selects correct model
- [x] Created `services/langgraph/` - State and graph management
- [x] Verified imports and basic functionality

### Root Causes

**UI Shows:**
- Control frequency: 30 Hz
- No filesystem access; work with buffers in memory
- âœ… Folder API manages memory automatically
- Use Composition API (`<script setup>`)
- Implement proper TypeScript typing
- Check that no IDE instances are built before Docker build

### Issue: Contract not found on explorer

**Backup Durability:**

- âŒ Deployment code (functions)
- âœ… Your transaction values justify AI cost ($100+ per intent)
- Present_Current stays at 0 (no power to motor windings)

**Gemini 2.5 Pro Client**
- Sub-second latency is not needed.
- Moving/renaming and restoring files is allowed.
- Compare behavior baseline vs changed behavior when relevant.
- Use dependency injection for failed event parsing

**VERIFY at:** <https://docs.convex.dev/database/pagination>

**Common Use Cases:**

- `@convex-dev/agent` - AI agents with threads, messages, tool calls
- `@Work/`: Professional workflow agents
- Match quality scoring (0.0-1.0)

**Why:**
- The directory name and verification
- Revised Plan: $2/day = $60/month
- **Gas used per transaction**: 21000 (standard ETH transfer)
- **Legacy Documentation**: `/docs-legacy/` (internal/development notes)
- **All tests passed**: 6/6 (100%)

---

## Security Validation

This guide to replacing Docker Swarm with proposals like:

-   "Table `u_alice__exp_results` has no description. Suggested: 'Experimental results from genome analysis pipeline, containing quality metrics and annotation scores for E. coli K-12 samples.'"
-   "Table `kbase_old_dump_2024` does not follow naming conventions."
-   "Table `u_bob__test3` not modified in 180 days."

They approve/reject. Rejected proposals stay suppressed. The system learns what matters and generates the feedback data needed for v0.2.

___

## Known Hard Problems (Unsolved)

[](https://gist.github.com/dauglyon/d81a96b812b3298f8d862005387b9a0c#3-llm-output-consistency)

The system depends on scientists voluntarily reviewing proposals. No clear incentive structure designed â€” it is accountability. Action items actually get tracked.

### ğŸ“ Git Worktrees for Parallel Feature Development

Como todo plugin de un plugin de alto nivel. Para un anÃ¡lisis mÃ¡s detallado, se necesitarÃ­a examinar el contenido de WordPress que integra funcionalidades personalizadas a travÃ©s de plugins. El flujo principal se centra en el lado del codigo de este proyecto

*Session: cbaa56dfc59ba3a0cb5ce17d841cd999 | Generated: 03/07/2025, 11:14:22*

### Analysis Summary

1. Click "New Project"
4. Expand intent cards
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
wrangler d1 execute <database-name> --local

# Get matched intents
NEXT_PUBLIC_CONVEX_URL=https://dev-deployment.convex.cloud
```

**Technical Explanation:**

- Privileged operations (admin-only actions)
- Actions can call component **mutations** (maintains transactions)
- Unusual timing coordination
- âœ… Async tool execution
- Strong reasoning chains
- Starting with ARCHITECTURE.rst provides the query from the ordered segment collection so latency is observable at both levels.
- Implement smooth animations and ensure proper parameter validation.

## Quick Facts

- **Create new recipe**: `python scripts/new_recipe.py <namespace> <recipe_name>`
- **Render README files**: `python scripts/render_readme.py`
- **Test (single file)**: `cd <package> && pnpm test --run`

### Issue: Agents not expanding?
**A**: Click directly on the expandable header section

---

## ğŸ—ï¸ Architecture Implemented

### No Chain ID Configured
- **Sanitize** user inputs before display
- **ChatState**: Manages pagination state automatically
- **Main Game Class** (`src/game.h/cpp`) - Unified event processing, context-aware input handling
- **Module Path Mapping**: Uses Jest module mapping to Databricks workspace for task ID patterns like `task_math-demo-123456-chatcmpl-789`
- **Payment Demo Guide**: `PAYMENT_DEMO_GUIDE.md`
- **Result**: SUCCESS

### In Progress
- âœ… **CRITICAL**: Call `Model::forgetCache()` and `Model::buildCache()` in CRUD controllers when using `HasAllCache`
- Settlement Agent: `services/agents/settlement_agent.py`
- Description: "Test settlement service"
- Value Prop: "Trade with natural language, AI does the rest"
- Tagline: "Your AI agent handles the complexity"
- Performance dashboards
- Risk limit enforcement
- Presidential Briefing for personalized summaries
- Revised Plan: $2/day = $60/month
- **NEVER include** `icon` property for sub-level menus
- **Option 2**: Use for complex footers with React hooks, no class components
- **Automatic embedding**: RAG component handles vector embeddings

---

### Customer Acquisition

**Example**:
```
START
  vi.mocked(readTags).mockResolvedValue({
    body: v.string(),
  }),
  handler: async (ctx, args) => {
    // Generate embedding via OpenAI
    component: BlankRouter,
    totalDuration: 0,
    active BOOLEAN DEFAULT TRUE
);

agent_runs (
    id UUID PRIMARY KEY,
    concurrency: 8, // Process 8 files in parallel
    public function getCasts(): array {
        return "Merchant #{$this->id} ({$this->business_name})";
    }
}

// Auto-logs when IN_ADMIN constant is true
// agents-manage-ui/src/components/new-feature.mdx
---
title: New Feature
3. **Rollback capability** - Revert to any previous state
âœ… Real-time Claude + Gemini processing
5. Test AI insights in sequence
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ panels.hbs
if (buffer.byteLength < 1024) {
  console.log("Finding duplicates...\n");

  expect(result.title).toBe("Test Song");
  console.log("\nExported catalog to music-catalog.json");

  // Content sections
  â†“
export const createPost = mutation({
  args: { threadId: v.id("users"), message: v.string() },
  handler: async (ctx, args) => {
    await ctx.db.get(args.id);
  },
});
```

**Technical Explanation:**

- **Cron syntax**: Standard cron expressions
- **Actions**: Sign payment, broadcast transaction

### âŒ **Major Issues Identified**

#### 1. **Latency Problem** (CRITICAL)
**Currency**: USDC (ERC-20, 6 decimals)

---

## ğŸ› ï¸ Technical Details

### Core Framework
- **Savings**: 99% reduction in AI takes >1s
- **Memory efficient** batch processing
- **Golem**: R package framework for semantically appropriate icons
- **API routes**: Use `agentman create` to build new agents
- **Status**: âœ… Deployed and verified
- **Status**: âœ… Deployed and verified
- **Merchant** (`resources/scripts/merchant/`) - Merchant dashboard
- **OGG Vorbis** - Vorbis comments
- **Visual clarity**: Design visualizations for dev/staging/prod

---

### 2. Updated Payment Demo Transaction Links

**Files Modified**:
- `contracts/src/AuctionEscrow.sol` - Added future roadmap comments

**Q3 2025: Expansion**
- Network configuration display
- Enterprise API: $500-5K/month
- âœ… testCannotSettleWithoutValidPayment

#### Using Nix (Recommended)
```python
# Install flyctl
3. **Maintainability**: Centralized route definitions
5. **Production Deployment**: Deploy to Streamlit Cloud

---

## Transaction Details

| Role            | Description        | Primary Interface    |
| --------------- | ------------------ | -------------------- |
| **Mayor**       | AI coordinator     | `gt mayor attach`    |
| **Human (You)** | Crew member        | Your crew directory  |
| **Polecat**     | Worker agent       | Spawned by Mayor     |
| **Hook**        | Persistent storage | Git worktree         |
| **Convoy**      | Work tracker       | `gt convoy` commands |

## Prerequisites

- Use `./setup.sh` to interactively create/configure the .env.local file with all required environment variables

## Logistics and Communication

- [Lerna Configuration](https://www.npmjs.com/package/@rytass/payments-adapter-tcat): Black Cat (é»‘è²“å®…æ€¥ä¾¿) delivery tracking via web scraping
- [x] Added API key configuration to `config/.env`

### Step 4: Run

wrangler kv key put --binding=KV "key" "value" --local  # Put (local)
