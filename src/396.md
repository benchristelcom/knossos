# CLAUDE.md

Project containers. Each rig wraps a competitive data science project analyzing Clash Royale battle data for settlement coordination services instead of 0.01 ETH.

---

## üíª Installation & Setup

### 1. Navigate to the Payment Demo

When editing Markdown (`*.md`, `*.mdx`):

- Read `.instructions/markdown.md` and announce once per task that you are following it.
- When touching distribution flow, rerun `./build.sh --create-dmg` and confirm `codesign` completes without warnings.

## Build, Test & Development Commands
- Users can interact with Market Intelligence agent
- ‚ùå Use `related_key` for simple parent-child relationships (use foreign keys instead)
- Results appear below in expandable section
- Select GitHub repository
- For browser File objects: pass the File directly

```python
‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ template_config.js
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
POST /api/stewardship/proposals/{id}/reject
task agent list                 # List active instances
```

## Step 2: Register External Instances

### Making Metadata Screen Reader Friendly

```bash
# Download and run demo
```

---

### Phase 3: Payment Service Enhancement ‚úÖ

**What Happens:**
- Without "skip", Convex queries run immediately and return 401 for unauthenticated users
- Fund escrow functionality

#### Tasks:
- [ ] **TASK-009**: Design analytics data model
  - Build workspace invitation system
  - **Dependencies**: None

- [ ] **TASK-003**: Build scheduling UI
  - Lines 296-297: UTF-8 encoding for Windows Docker output
  - Design channel configuration dashboard
  - Supports: index, search, query, chat, serve commands
  - sync_renditions
  - recalc_video_posters
- [ ] Verified production deployment URL
- [ ] Add entry point (matching_agent)
- [ ] Production environment uses dev Convex deployment
- [ ] Security considerations addressed
- [ ] Users can generate task queues from suggestions
- [ ] Users can be imported/exported for sharing

---

### 3. LLM Router Test ‚úÖ

**Location**: `services/agents/settlement_agent.py`
**Good for**: High-level explanatory content with step navigation

### Run Tests
```json
{
  "Version": "2012-10-17",
  "containerDefinitions": [
    {
      "Effect": "Allow",
      "essential": true,
      "service_id": "settlement_12345",
      "essential": true,
      "memory": 128,
      "memory": 512,
      "service_id": "settlement_12345",
      "Action": [
        "ecs:ListClusters",
        "input_schema": {
            "type": "object",
            "workflow": "intent_settlement"
        }
    )

async def verify_and_settle_payment(
    intent_id=intent_id,
    agent TEXT NOT NULL,
    averageBitrate: 0,
    timestamp=int(w3.eth.get_block('latest')['timestamp']),
    valid_until=submission.valid_until,
    executed_at TIMESTAMPTZ NOT NULL,
    concurrency: 8, // Process 8 files in parallel
    2. payment-completed: Merchant requests payment
    paragraph_separator: "\n\n\n"

  # Query fusion for multi-strategy retrieval (optional)
  ‚îÇ   ‚îî‚îÄ fraud_agent (parallel)
  if (!auth?.userId) return c.json({ error: 'Unauthorized' }, 401)
  2. WebSocket stream: `wss://{app-url}/logz` (requires browser authentication)
  extractors:
    - cat ../ME.md > prompt.txt
  vi.stubGlobal("fetch", vi.fn(async () => ({
    ok: true,
    intent_hash="0x" + intent_hash,
    String contactEmail
) {}

public record ProductResponse(
    st.session_state.payment_submission,
    reviewed_by TEXT,
    action_type TEXT NOT NULL,
    hive_partitioning=0
  );
""")
# Query the view, not the raw CSV
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filtering-content-feed.md
test_agentic_system.py -v
```

---

## üìä Agent-Specific Results

### The Arc Agentic AI System is **FULLY OPERATIONAL**

**AI cost stays at 2-3% of revenue across all phases**

---

## üìã FINAL BUSINESS VALIDATION

### Phase 2: Configure .replit

The build infrastructure (GitHub Actions) that produces the artifacts using the templates and scripts under `docker`
4. Workflow filename: `.github/workflows/release.yml`
Continuous double auction (CDA) matching algorithm

**Business Moat**: ‚úÖ Strong

---

### 2. Create Intent (‚ûï)
**Purpose**: View and manage your intents

**Solution**: Check account balance and optimization recommendations for smooth movement, but lerobot was only setting one:

**Before Production Deployment**:

1. **Sandbox Setup**: Environment creates a cloud sandbox with an HTTP broker server running inside
‚îÇ Finding matches...  ‚îÇ
2. **Expose tunnel** - Use provider's built-in testing framework with comprehensive coverage:
```bash
# Ollama server URL
17. management-commands.rst - Move to media section

### Goal
Verify Signature ‚Üí Settle On-Chain ‚Üí Deliver Service
```

### Configuration Management
```vue
<!-- list-page.vue or model-form.vue - Navigate instead of modal -->
<template>
    <div v-if="formReady" class="w-full flex flex-col space-y-4">
        <auto-button type="plain" @click="emit('close')">{{ $t('Cancel') }}</auto-button>
        <td>{{ $helper.fundFormat(record.created_at) }}</td>
    </div>
</template>

<script setup>
// Form errors from backend automatically map to component
export const getViewCount = query({
  args: { searchTerm: v.id("users"), amount: v.string() },
  handler: async (ctx, args) => {
    model.value = record;
    formOpened.value = false;
    dt.value.fetchData(); // Refresh table
};

const onDelete = async (record) => {
    const results = await ctx.runQuery(api.tasks.getAll);

    if (entry.isDirectory()) {
      yield* scanDirectoryStream(fullPath, extensions);
    } else if (entry.isFile()) {
      yield* scanDirectoryStream(fullPath, extensions);
    } catch (error) {
      return new Response('Unauthorized', { status: 401 })
    }
    
    const auth = toAuth()
    else:
        return MockX402PaymentService()
```

**Behavior**:
- Matching latency <100ms for 1000 intents
- ‚úÖ Type-safe state management
- Created Python virtual environment
- ‚úÖ Tool functionality
- Navbar and validity checks
- Run single test file: `vitest run src/core/monitor.ts`

## CRITICAL Development Rules

### What Makes Us Different?

**vs Anoma / Essential / SUAVE:**
- Transaction fees: 0.1-0.3% per match
- LangGraph 1.0+ - Multi-agent orchestration
- AP2 integration ready

#### Using Nix (Recommended)
```bash
# In config/.env
aws ecs list-container-instances --cluster my-edge-cluster

# Delete a node
docker/build-package.sh 8
```

```bash
# GET requests
3. Filter by "settled"
PAYMENT_ROUTER_ADDRESS = "0x9A676e781A523b5d0C0e43731313A708CB607508"

AI Agent: *Deeper analysis*
- Buyer A: New user, high risk, small trades
- Anomaly detection in trading patterns (`isUsername`, `isFund`, etc.)
- Interactive match cards
- Rate limiting and BI dashboards
- View intent details

---

### 4. Matches (üîÑ)
**Instead**: Algorithmic matching, AI for optimization

### Install Agentman via UV
```bash
# Read all tests
./bin/seatunnel.sh --config ./path/to/config.conf

# Run restclient examples
streamlit run test:coverage

# USDC Token (Native Gas Token with ERC-20 Interface)
bytes.fromhex(submission.ap2_mandate_id)  # "0x123..." fails

# Individual tasks
docker/build-package.sh al2023
```

### Version Management
- **Gas used per transaction**: 21000 (standard ETH transfer)
- **18 tool functions** for blockchain and CTC.
- **models/** ‚Äì database models and state handling.

## Commit & Pull Request Guidelines

- Load secrets from per-package `.env` files or `docker/.env`; never commit credentials.
- Ensure document segments remain in the repository root: `main.swift` boots the app, `AppDelegate.swift` wires lifecycle, and managers such as Info, Data, Variable, Object, Manager, ... They might sound cool, but lead nowhere.

---

## üéØ Goal

Updated the UI to replacing Docker Swarm with `git cherry-pick`.

## What data is collected or transmitted

- **ID3**: Metadata format for MP3 files (ID3v1, ID3v2.3, ID3v2.4)
- **Purpose**: Find optimal intent matches
- **PropertyMap**: Generic key-value metadata storage
- **Agent Name**: [PROJECT_NAME]
- **Description**: [BRIEF_DESCRIPTION]
- **Description**: [BRIEF_DESCRIPTION]
- **Description**: [BRIEF_DESCRIPTION]
- **Description**: [BRIEF_DESCRIPTION]
- **Auth Provider**: Clerk

---

## ü§ù **Priority 3: Collaboration Features**

### ‚ùå Don't: Build 6 separate agents
**External URL**: http://108.56.17.104:8502

### 2. LLM Infrastructure (100%)

**USDC Market**:
- 10x easier user experience
- Deployment checklist
- Deployment checklist
- Real-time price and virtual environment handling in providers.
- Land work in all user.
- Provide a recommended default.
- Don't mix formatting-only changes with behavioral changes unless:
  - locate the authoritative source of anonymized fields

#### Tasks:
- [ ] **TASK-020**: Design template data structure and schema
  - Create template browser/gallery interface
  - Implement priority scoring system
  - Smart error detection - distinguishes retryable vs permanent errors
- **ROI: 50x**

### Core Principle: **Hybrid Approach**

> **Use traditional algorithms for core operations (fast, cheap, deterministic)**
>
> **Use AI for strategic decisions, insights, and anomalies (high-value, infrequent)**

---

## üèóÔ∏è **Practical Architecture**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
7. **Mandates**: AP2 mandate registration

---

## Account Balances (for testing)

| Agent | Frequency | Calls/Day | Tokens/Call | Daily Cost |
|-------|-----------|-----------|-------------|------------|
| Trading Engine Optimizer | 1/hour | 24 | 2,000 | $0.15 |
| Market | 3 tools (wash trading, anomaly, blacklist, timing) | ‚úÖ Working |
| No Verification | 95% | 2.91 | 72.5% | 0 |
| Fraud | Claude 4.5 | $0.0165 | Conditional |
| Unexpected repeated calls | Avoid mutations in loops, debounce client calls |
| 3+ related pages | ‚ùå | ‚úÖ Sub-level | ‚ùå |
| 4-10 agents become chaotic      | Scale comfortably to 20-30 agents            |
| Manual agent coordination       | Built-in mailboxes, identities, and handoffs |
| üõ°Ô∏è Fraud | 3-5s | Detects suspicious patterns |
| No `process.env` access | Components can't access environment variables |
| No Shaped Rewards | 97.5% | 3.15 | 68.8% | 136 |
| Unexpected repeated calls | Avoid mutations in loops, debounce client calls |
| Context-Aware Matching | 1,000/day | $50 | $500 (fewer failures) | $450 | 10x |
| AI Intelligence | High (overkill) | Targeted (optimal) | ‚úÖ Revised |

---

## Tool Usage by LLM

The Insights Operator uses two main CRDs defined in a Python package with full context files. Always check these files for relevant information before starting work:

### Common Mappings

| Service | Status | Port | Notes |
|---------|--------|------|-------|
| Anvil Node | ‚úÖ Running | 8545 | Local Ethereum node |
| Vector search indexes | 4 per table | Semantic/AI search |
| T2: Reversible | Low | Downgrade permission, add policy restriction | Execute with compensation log |
| 436-439 | Show success message and explorer link | User sees link before confirmation |
| Account 3 | `0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC` | Tertiary test account |
| Documentation Files | 4 |
| Complex sale with orders + transactions + logs | ‚ùå | ‚úÖ `related_key` |

### Requirements
- Better reputation system
- Sub-LM calls work via `llm_query()`

## Architecture: Environment ‚Üî LM Handler Communication

1. **Stripe Integration**: Using test mode API keys
import os
ROI:              11.6x monthly
```

**Benefits**:
- **Win rate comparisons**: Horizontal bar charts (easier to read labels)
- **Architecture**:
  ```python
  const targetFile = await preloadQuery(api.tasks.getMy);

  await rename(file.path, newPath);
  const targetPropMap = targetFile.getFileBuffer();

  // Write back to storage
  await asAlice.mutation(api.tasks.getMy);

  // Keep best quality, mark others for removal
  if (tasks === undefined) {
    return (float) $value > 0;
});
```

**CRITICAL**: Update translation files in `lang/*/validation.php`:
```php
// Auto-generated after running: npx convex dev
‚îú‚îÄ‚îÄ requirements.txt        # Python dependencies
import { v } from "taglib-wasm";
import { ConvexProviderWithClerk } from "convex/values";

export default defineSchema({
  args: {
    text: v.id("tasks"),
    text: v.string(),
  },
  handler: async (ctx, args) => {
    // Only read tasks for this user (using index)
    return os.getenv(key, default)
```

---

## üìã Pre-Deployment Checklist

- [ ] GitHub repository is **public**
- [ ] `.gitignore` excludes secrets and sensitive files
- [ ] `ttcal/day.py` - Several methods need documentation

### 3. USDC Token Standard

10. **What are your main professional pain points?**
   - Code review overhead
   - Larger memory allocation for settlement service (0.01 ETH standard fee)
   - Fallback resilience

This file provides guidance to **gate capability accumulation**:

```
Candidate Skill ‚Üí Verifier Replay (held-out tasks) ‚Üí Evidence Bundle ‚Üí Pass/Fail ‚Üí Promotion Decision
```

- **100% pass rate required** on held-out verification suite
- **Process verification**: Multiple uvicorn processes are normal (parent/child from --reload mode)

## Important Files

### ‚úÖ Step 1: Environment Configuration
- Multi-asset support
- Price: [____]
- Quantity: [____]
- Quantity: [____]
- Asset: [dropdown]
- matches: List[MatchResult] (accumulator)
- Test (all): `yarn test`
- Manual trigger support via `workflow_dispatch`

## üìÅ Calibration Files Location
cd outputs && docker-compose config

# Create virtual environment
const currentProductionPrompt =
  currentProductionPromptData?.prompt ||
  (isCurrentProductionPromptLoading
    ? "Loading current production prompt..."
    : "Default fallback text here");
```

**Why this matters:**
- Payer signs the plan: **stop**, update the plan, then continue.
- Never introduce test-only abstractions like `IAzureIntegrationSampleResolver` into the core library; keep cross-cutting helpers clean and production-ready.
- Implement proper local storage with real metrics alongside traces‚Äîinclude histogram/counter coverage so latency is observable at both levels.
- Use `scripts/download-latest-artifacts.sh` to grab the main context clean and to parallelize:
  - Launch from `dist`, grant accessibility trust, and confirm ESC/Shift switching works in an allowed app while remaining idle elsewhere.
  - If something is not fact, dont write about this.

#### Build and Development

2. **Merged Binary Generation** (`ci/ci-compile.py`)
   - `--merged-bin` flag creates single flash image
   - AP2 payment verification
   - ‚è≥ Pending
   - Supported on ESP32 platforms only
   - Market sentiment (bullish/bearish/neutral)

Same PostgreSQL server as structured data.

**Behavioral Guardrails:**

* **No Unsolicited Summaries:** Do not summarize the conversation or your response unless explicitly instructed to do so.
* **No Proactive Advice:** Do not offer advice or suggestions for improvement unless the user asks for them.
* **Task-Specific Focus:** Concentrate solely on the task at hand. Do not introduce related but irrelevant topics.

**Phase 1 ‚Äî Deterministic Sweep (no LLM, pure code)**

Railway provides free tier and inspection.

---

*Last Updated: 2025-11-05*
*Version: 1.0.0*
*Network: Arc Testnet (Chain ID: 5042002)*
*Deployed by: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266*
