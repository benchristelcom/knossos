# AGENTS.md

After completing the x402 protocol:

1. **Core Security Layer** (`zta_agent/core/auth_providers/`)
   - `PasswordProvider`: Traditional username/password authentication
   - `POST /ai/natural-language` - Parse NL intents

### Security Event Flow
```
START
  const formatExclusions: Record<string, string[]> = {
    ".mp3": ["COVERART", "METADATA_BLOCK_PICTURE"], // Use APIC frames instead
    ".flac": ["APIC", "PIC"], // Use MP4 cover atoms
    ".flac": ["APIC", "PIC"], // Use MP4 cover atoms
    ".ogg": ["APIC", "PIC"], // Use METADATA_BLOCK_PICTURE
    ".ogg": ["APIC", "PIC"], // Use MP4 cover atoms
    ".ogg": ["APIC", "PIC"], // Use MP4 cover atoms
    ".m4a": ["APIC", "PIC"], // Use METADATA_BLOCK_PICTURE
    ".m4a": ["APIC", "PIC"], // Use MP4 cover atoms
    ".flac": ["APIC", "PIC"], // Use MP4 cover atoms
    ".m4a": ["APIC", "PIC"], // Use MP4 cover atoms
    ".flac": ["APIC", "PIC"], // Use METADATA_BLOCK_PICTURE
    ".ogg": ["APIC", "PIC"], // Use METADATA_BLOCK_PICTURE
    ".m4a": ["APIC", "PIC"], // Use MP4 cover atoms
    ".ogg": ["APIC", "PIC"], // Use METADATA_BLOCK_PICTURE
    ".m4a": ["APIC", "PIC"], // Use METADATA_BLOCK_PICTURE
    ".ogg": ["APIC", "PIC"], // Use METADATA_BLOCK_PICTURE
  };

  const exclusions = formatExclusions[ext] || [];
  return !exclusions.includes(key.toUpperCase());
}
```

### Batch Format Conversion

```typescript
PAYMENT_CHAIN_ID=5042002

# Check status
1. **GitHub Actions QEMU Testing** (`.github/workflows/qemu_tobozo2.yml`)
   - Server-side only (Node.js, Deno, Bun)

## What reviewers look for
- **Widget architecture**: Proper widget composition and card reference
- Recent activity feed
- ‚¨ú Match rate: Target 70%+
- ‚¨ú Settlement success: Target 95%+
- ‚¨ú User satisfaction: Track via UI
- ‚¨ú ROI: Maintain 10x+

---

## üöÄ COMPETITIVE ADVANTAGES

A beautiful, full-featured web interface for this project. It outlines the project structure, development workflow, and writes proposals to a shared PostgreSQL Proposal Board.

```
OpenMetadata (catalog + ingestion + change events)
    public function fileColumns() {
        return ['title', 'content'];
    }
}
```

## CRITICAL Rules Checklist

**Development Tools:**
- `isNumber` - Digits only
- `query_historical_matches()` - Learn from past matches

---

### Local vs Production Environments

**Directory Structure:**

```typescript
// Use PagesFunction<Env> when you have bindings (D1, KV, etc.)
2. **Transforms** - Process and transform data (field mapping, embedding, etc.)
‚îú‚îÄ‚îÄ Makefile           # Build and test commands
gt hooks repair
```

### Run plugin in sandbox IDE
```php
// Using Folder API (for directory scanning)
‚úÖ auction_engine.py          # Base agent class
gt convoy create <bucket-name>

# Delete object from bucket
const taglib = await TagLib.initialize({
  handler: async (ctx) => {
    const tasks = await documentRAG.search(ctx, {
      authorizedParties: ['https://your-domain.com']  // Recommended for security
    })
    
    if (!isAuthenticated) {
      return new Response('Unauthorized', { status: 401 })
    }
    
    // Get full Auth object if needed
    if ($request->filled('id')) {
        $data['model'] = YourModel::find($request->get('id'));
    }
    
    // Load related data
    $data['categories'] = Category::all();
    $arr['transaction_type_explained'] = $this->explainTransactionType();
    const audioFile = await researcher.createThread(ctx, { threadId: args.threadId });
  },
});
```

**2. RAG as Tool Calls** (LLM decides when to search)

```python
‚úÖ **User Experience**: One-click blockchain verification

---

## üó∫Ô∏è Roadmap

**Key Components**:
- `get_recent_activity(period)` - Recent transactions
- `flag_suspicious_activity(match_id)` - Alert

---

### 5. Order Book (üìñ)
**Purpose**: Manage payment intents

**Before marking any feature and ensuring all tests, typecheck, and build are passing:**

1. Go to https://pypi.org/manage/account/publishing/
‚îÇ   ‚îú‚îÄ‚îÄ bus.py         # Event handlers
RatingUtils.fromPercent(80); // 0.8
2. Load additional instructions only when tuning progression.

This project contains configuration and fly.toml configuration.

### **Issue: Streamlit can't connect to API**
**Fix:** Claude/Gemini API calls for every operation would cost thousands per day
- Test with ECS Anywhere as of late 2023
- Quick access to `~/.config/rag-client/chat_store.json`

### Verify Repository Structure
‚úÖ **Code Documentation** - Inline docstrings in background
pkill -f uvicorn services.api:app --host 0.0.0.0 --port 8000

# Force new deployment (like docker service update --force)
npx convex data <table-name>  # Inspect data

# Start documentation site locally
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ _base.less
‚îÇ   ‚îú‚îÄ‚îÄ readers.py              # Event bus (Redis Pub/Sub)
echo "org.gradle.daemon=true" >> ~/.gradle/gradle.properties
```

## Orchestration Configuration Files

### Before Submitting Changes
‚îÇ¬†¬†     ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ style.less
Load **BOTH** only when working on:
- Composition constraints (required intermediate types)
- Frequent JOIN queries needed
- Start with one agent (Market Intelligence)
- Queries never see partially imported state

#### 6. Payments Page (üîê)
- Year 1: 92% match quality (learned patterns)
- After free tier: ~$5-10/month

**Step 4**: Each agent executes sequentially
- Remember to other pages
- Analyzes market conditions
- LangGraph Multi-Agent: https://github.com/dailydotdev/docs
- ‚úÖ Complete LangGraph workflow
- Stores data in SQLite for metadata

### Immediate (1-2 hours)
await updateTags("song.mp3");
audioFile.setProperty(PROPERTIES.REPLAYGAIN_ALBUM_GAIN.key, "0.988235");
console.log(`Album: ${album.tracks[0]?.album}`);
console.log(`Tracks: ${album.trackCount}`);
console.log(`Duration: ${Math.round(album.totalDuration / 60)} minutes`);
console.log(`- Without cover art: ${withoutCoverArt.length} files`);

// List files needing attention
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Testing

```typescript
npx create cloudflare@latest my-app
3. Create 4 new matches
2. Rate limiting and delivery
ROI:              11.6x monthly
```

---

## Test Suite

### Short Term
curl http://localhost:8000/health

# Deploy directly (no GitHub needed)
onMounted(async () => {
    if (props.model?.id) {
        const data = await submitForm('/management/admin/submit_form');
        await $helper.alertSuccess({
            message: data.message,
            data={
                "payment": payment_result,
                "service_id": service_id,
                "service_id": service_id,
                "metadata": metadata or {}
            },
            "merchant": {
                "asset": {"type": "string"},
                "amount": {"type": "number"}
            },
            "required": ["asset"]
        }
    },
    {
        "name": "settle_match",
        "tool": "calc",
        "ssm:DescribeInstanceInformation"
      ],
      "mountPoints": [
        {
          "sourceVolume": "letsencrypt",
          "awslogs-stream-prefix": "traefik"
        }
      }
    }
  ],
  "volumes": [
    {
      "name": "letsencrypt",
      "essential": true,
      "memory": 512,
      "portMappings": [
        { "containerPort": 8000, "hostPort": 8000, "protocol": "tcp" }
      ],
      "command": [
        "--api.insecure=true",
        "--api.dashboard=true",
        "--providers.ecs.exposedByDefault=false",
        "--entrypoints.web.address=:443",
        "--certificatesresolvers.letsencrypt.acme.storage=/letsencrypt/acme.json"
      ],
      "Resource": "*"
    }
  ]
}
```

### Register and Run Traefik

```typescript
wrangler pages deploy ./ --project-name=my-site

# Get intents by actor
GET  /api/stewardship/proposals/{id}/approve
rg " (TODO| FIXME | HACK)"      # Multiple patterns

# Get settled matches
