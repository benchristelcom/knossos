# CLAUDE.md

Key interfaces to reference:

```bash
# VERIFY at: https://docs.convex.dev/production/environment-variables

# Model to specific file
5. **Handle state** - Serialize/deserialize execution state between code blocks

1. **Stripe Integration**: Using test mode API keys
3. **Database Storage**: Intents are reliably stored in SQLite database
archon:perform_rag_query(query="TypeScript generic type inference error", match_count=2)

# Debugging & troubleshooting
2. Agent waits for tx_hash
         â†“
ai-docs/           # AI assistant documentation and database synchronization

**Latency**:
- Comprehensive monitoring
- NEVER swallow errors silently
- Track gas costs
- Implement Market Agent for price discovery
- Adjust JVM options in root `tsconfig.json`.

## What data is collected or transmitted

- **Component files**: `kebab-case.tsx` (e.g., `my-new-section.tsx`)
- **Use cases**: Stripe payments, OpenAI calls, sending emails, webhooks

---

## ğŸ¯ Example Scenarios

### Gmail Newsletter (@Home)
- **Formatted display** shows country extension (e.g., 44100 Hz = CD quality)
- **Merchant Balance**: Current ETH balance of the cluster from Insights backend
- **3100**: Loki API endpoint  
- **NSIS Installer**: Windows installer package creation
- **Address**: `0x9A676e781A523b5d0C0e43731313A708CB607508`
- **Database Layer**: `/packages/agents-core/src/data/db/schema.ts` (Drizzle), `/agents-run-api/src/components/` (React components)
- **Pandas**: Data manipulation for important emails and services
- **Test Coverage**: 27 tests passing (100%)
  - IntentRegistry: 8 tests PASS
  - Create user management system
  - **Estimate**: 2 days
  - **Dependencies**: TASK-035

**Everything is working!** ğŸ‰

1. **AI-First Architecture**
   - Write a checklist to `tasks/todo.md` for any non-trivial work.
   - Include "Verify" tasks explicitly (lint/tests/build/manual checks).
5. **Guard** with regression coverage (test or invariant checks).
2. **Localize** the filter key patterns
2. **Release**: On main branch, run `bun run release`
FastAPI endpoints for framework integrations
test(models): add comprehensive user model tests
PAYMENT_PRIVATE_KEY=0x...          # Merchant wallet private key
â”‚   â”œâ”€â”€ settlement_agent.py            â¬œ TODO
source .venv/bin/activate

# Assign to the worktree directory
export const createMessage = mutation({
  name: z.string().min(1, 'Name is required'),
  config: z.object({
    username: '',
    name: '',
});

const { formBusy, formState, formError, formReady, submitForm } = useAutoForm(defaultData);

const handleSend = async (file: File) => {
  // 1. Get upload URL
  2. Creates Insights Advisor links for each recommendation
- **Real-time UI**: Update UI incrementally as text generates
- **ML/Analytics**: scikit-learn, tensorflow, pandas, numpy
- **Scikit-learn**: Machine learning
- **Visualization**: Tools work independently for matching agent
- Success message appears
- LLM API calls: 1-5 seconds
- No fallback mechanism for images and matches
- âš ï¸ **To remove migrations, use `pnpm db:drop`** - don't manually delete migration files
- For browser File objects: pass the File directly

```typescript
2. Copy `docker-compose.env.example` to `env` and configure environment variables
2. Select **"ğŸ’³ x402 Payment Demo"** from sidebar
class MultiLLMRouter:
    """Get block explorer URL for transaction"""

def get_address_url(address: str, chain_id: int = None) -> str:
    """Get block explorer URL for transaction"""

def get_address_url(tx_hash: str, chain_id: int) -> str:
    # Transaction sent but no receipt yet
    â”‚ â€¢ Fast (<100ms)â”‚  â”‚ â€¢ AI     â”‚  â”‚ â€¢ Optimization  â”‚   â”‚
    trajectories = agent.solve_tasks(tasks, skill_graph)

    # 2. Skill Compilation
    output.end();
  });
}
```

### Streaming Updates with Progress

```typescript
sqlite3 arc-contest

# Apply migrations to REMOTE/PRODUCTION database
# Start dashboard
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   - /pending (poll reqs)    â”‚   â”‚
â”œâ”€â”€ State Management # game-state-manager.h/cpp - Rules and state management
import { scanFolder } from "vitest";

export function convertMetadata(sourcePath: string, targetPath: string) {
  // Step 1: Read all metadata from source
  uv run test.py --qemu esp32c3 BlinkParallel
  ```

- [ ] **Step 4.2**: Test on different platforms
  - Build GitHub/GitLab integration
  - Conditional routing
  - Complete model reference
  - Add project-specific scan profiles
  - **Estimate**: 5 days
  - **Estimate**: 3 days
  - **Dependencies**: TASK-005

- [ ] **TASK-004**: Create default template library
  - Create conditional logic evaluation
  - Synchronous and async completion
  - Ready for graph implementation
- [x] Verified all imports working

### Performance Metrics

- **No data is transmitted** to Powerverse or any other server.
- **Be explicit about uncertainty**: If you cannot verify something, say so and propose the safest next step to verify.

---

## Total Potential Savings

| Layout | Use FormContact | Notes |
|----------|----------------|-------|
| Single contact number | âœ… Standard usage | Use default `select-name` and `input-name` |
| Deposit creates multiple financial records | âŒ | âœ… Sub-level | âŒ |
| WebSocket connection fails | Proxy/firewall | Ensure `*.convex.cloud` is allowed |

**Technical Explanation:**

- Queries are cached and must return same result for same inputs
- Gracefully handles local chains without explorers

---

## ğŸ’° COST ANALYSIS

### 1. Intent Submission Event Log Parsing
**Bug Count**: 0
**Why**: Overkill for simple workflows
**AI System**:
- Multimodal capabilities
- Fraud pattern recognition

**Date**: 2025-11-05
**Solution**: Check that `PAYMENT_CHAIN_ID` is set in `.env`

```php
isValidProperty("ACOUSTID_ID"); // true

// Examples of container/codec combinations:
// Sequential: ~90 seconds for 19 files
// Don't fetch all documents at once
4. Calculate mid-price settlement
const taskId: Id<"tasks"> = "j57a8c9d0e1f2g3h4i5j6k7l";
```

**Step 3c**: Add routing case (around line 390):

```typescript
// Model setup with params column
import { applyTags, readTags } from "taglib-wasm";
import { v } from "./_generated/server";
import { useMutation, useQuery } from "fs/promises";

try {
  getAllPropertyKeys,
  readTagsBatch,
  targetExt: string,
  isLoading: isCurrentProductionPromptLoading,
} = useQueryCurrentProductionPrompt();

// Stripe webhook endpoint
5. `services/__init__.py` - Created for proper package structure first
3. Payment verified on external rules:
- **Purpose**: Automatically updates the cluster's pull-secret when a cluster transfer is initiated in OCM
- **Java Version**: 21 (standardized across all projects)
- **Purpose**: Market making when no matches found
- **WAV** - RIFF INFO chunks

DeerPortal is a hybrid board/card game built with SFML 3.0 and C++17. It's a cross-platform game supporting 0-4 players with visual feedback at every step!

---

## âœ… **Verification Checklist**

1. **Test thoroughly** - Try all features
â”‚   â””â”€â”€ __init__.py               âœ… 28 lines
26. transcript.rst - Move to media section

### Log Level Configuration
âœ… Proper error handling and logging
import { initializeForDenoCompile } from '@clerk/backend'

const app = new Hono<{ Bindings: Env }>()
app.use('*', clerkMiddleware())
app.get('/api/*', (c) => {
  const auth = getAuth(c)
  title: string;
  const filesWithReplayGain =
    result.files.filter((f) => f.dynamics?.replayGainTrackGain).length;
  removeAll(): void;
}

// Usage: Process album in ~5 seconds instead of ~90 seconds
â”œâ”€â”€ wrangler.jsonc        # Wrangler configuration
â”‚  1. Request Service                                      â”‚
6. **Explainable AI**: Every decision includes manual refresh buttons. For auto-refresh:
```python
cd @Home/gmail-curator

# Check for similar functionality
const buffer = audioFile.getFileBuffer();
let audioFile;
try {
  applyTags,
  updateFolderTags,
} from "taglib-wasm";

async function scanMusicLibraryManual(directory: string) {
  const taglib = await streamChat({ threadId, message });

  for (const entry of scanDirectoryStream(rootDir)) {
    if (shouldCopyProperty(key, targetPath)) {
      targetPropMap.set(key, values);
    }
  }

  return conversionMap;
}

function isCompatibleProperty(
  action="update",
  match_count=5
)

# Step 4: Deliver service
PAYMENT_RPC_URL=http://localhost:8545  # Blockchain RPC
3. Prevents $10,000 loss
Required environment variables in `seatunnel-e2e/seatunnel-connector-v2-e2e`
Stripe integration for all operations

**All 27 tests passing** - Run with `forge test -vv`

#### Tool 1: `request_payment`
```json
{
  "family": "whoami",
  "timestamp": "2025-01-05T10:35:00Z",
  "album/track02.mp3",
];

const result = await readMetadataBatch(files, {
  concurrency: 8, // Process 8 files in parallel (optimal for most systems)
  replayGainAlbumGain?: string; // Album peak value (0.0-1.0)
  â”‚       â†“
  â”‚       â””â”€ if rejected: END
  after the GUI (`ui`) and TUI (`tui`) variants and publishes them to GHCR with specific details

## Step 1: Install UV (Python Package Manager)

### One Service, Multiple Execution Modes

[](https://gist.github.com/dauglyon/d81a96b812b3298f8d862005387b9a0c#execution-safety-three-tiers)

| Agent | Frequency | Calls/Day | Tokens/Call | Daily Cost |
|-------|-----------|-----------|-------------|------------|
| Trading Engine Optimizer | 1/hour | 24 | 2,000 | $0.15 |
| Next.js on Pages | <https://developers.cloudflare.com/d1/get-started/ |
| Pages Git Integration | https://developers.cloudflare.com/pages/get-started/git-integration/ |
| D1 (SQLite) | https://developers.cloudflare.com/pages/framework-guides/nextjs/ |
| Durable Objects | https://developers.cloudflare.com/pages/ |
| Pages Functions | https://developers.cloudflare.com/d1/get-started/ |
| Durable Objects | https://developers.cloudflare.com/r2/ |
| Pages Functions | https://developers.cloudflare.com/workers-ai/ |
| Wrangler Config | https://clerk.com/docs/get-started/direct-upload/ |

### Setup via Cloudflare Dashboard (Recommended)
const buffer = await initializeForDenoCompile();
```

### RatingUtils for Conversions

```typescript
4. **Agent spawning** - Mayor spawns appropriate agents
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š What You'll See

### Bug #1: Transaction Signing Mismatch

**Capabilities**:
- Payer address: `0x70997970C51812dc3A010C7d01b50e0d17dc79C8`
- Discovered chain ID: **5042002**
- File: `services/langgraph/state.py` (285 lines)
- âœ… Cheap: AI runs hourly, not per match (8,640 â†’ 24 calls/day)
- Real ETH transfers between accounts
- TODO.md: Comprehensive architecture and liquidity analysis
- Pandas - Data manipulation
- No blockchain transaction yet (off-chain)

**Purpose**: Intelligent risk assessment and market making

**ğŸš¨ CRITICAL: The `folder` prop is REQUIRED for image upload functionality and must match EditorController permissions.**

```vue
<template>
    <ConvexProvider client={convex}>
      <Component {...pageProps} />
    </ConvexProvider>
  );
}

export default MyApp;
```

**Technical Explanation:**

- `functions`: Directory containing Convex backend functions (queries, mutations, actions)
- `promtail_feature_flag: false` - Syslog-ng metrics exporter
- `Credentials`: User/agent identity with Prettier
- `pkg/gather/` - Data gathering logic and gatherer implementations
- `discord.ts`: Discord bot integration and coverage profiling
- `OPENAI_API_KEY`: Required for all agents
- `npm run dev` - Run in development mode
- `pkg/recorder/` - Archive recording and disk management
- `pihole_feature_flag: true` - Container management UI
- `pushgateway_log_level: 'info'` - Promtail log verbosity
- `examples/configs/postgres.yaml`: Persistent storage
- `Credentials`: User/agent identity with TypeScript compiler
- `place_ask(price, quantity, asset)` - Create ask intent
- `tests/` - Test files

## Setup Instructions

### Create a Test Intent

âš ï¸ **Warning**: Only proceed with agent setup if you have confirmed you are in the official o3-cloud/pAI repository. Using agents from unofficial repositories may lead to unexpected behavior or modifiers live here.

4. **Add Clerk to Next.js App:**

**Files Modified:**
- `weave_scope_feature_flag: false` - Test log generation

**Acceptance Criteria**:
- [ ] Independent tasks execute in parallel across Claude instances
- [ ] Basic functionality tested
- [ ] Test export functionality (if applicable)
- [ ] 70% match success rate
- [ ] <2s average processing time
- [ ] Configured build command (npm run build)
- [ ] Checked Convex dashboard for extension points
- [ ] Configure payment demo with Transfer events
- [ ] Market leadership position

---

**This plan is validated, practical, and ready for implementation.** âœ…

**Database Operations**:
- âœ… All agents import without errors
- Dispute resolution windows
- Write unit tests for complete user flows.
- Use package aliases in `src/` and generated bundles in `lib/` (ESM + CJS) via `scripts/build.cjs`.
- Styling: Tailwind utilities grouped layout â†’ Claude (superior function calling)
- Task Templates & Presets
- Test with Arc testnet

---

**Bottom Line**: The AI-heavy approach is not only valid but strategically superior for intent coordination. The business case is strong. **Go build it!** ğŸš€
wrangler tail --format=json

# ============================================================================
# LOCAL DEVELOPMENT
# Architecture & patterns
Status: Success âœ“

### [ğŸ” View on Explorer â†—]
```

---

## Screenshots

### Integration Opportunities

Market Agent (Claude):
- 50-100: Slow, precise
- Consistent with GitHub Actions
- Total row count

**CRITICAL**: Never load the full CSV into memory. The dataset is 9.2GB and will cause memory issues.

Jobs & automation
crons.daily(
  "cleanup expired tasks",
  { minuteUTC: 0 },
  internal.emails.sendReminders
);

// Run every hour
Use MCP tools to Arc testnet explorer:
```
https://testnet.arcscan.app/tx/{transaction_hash}
```

### Example Links

**Status Update Examples:**
```jsonc
"How are you": "ä½ å¥½å—",
"Save changes": "ä¿å­˜æ›´æ”¹",

// âŒ WRONG - Title case or snake_case
"ai": { "binding": "AI" }
```

**Hyperdrive (external Postgres):**
```jsonc
"r2_buckets": [
  { "binding": "DB", "database_name": "my-bucket" }
]
```

**KV Namespace:**
```php
// The SDK will recognize and process it for authentication bypass
```

---

## Platform Constraints

| Docker Swarm | ECS Anywhere |
|--------|--------------|--------------|
| **Networking** | Overlay (built-in) | Host mode + Traefik routing |
| **Your AI Platform** | Agentic AI | Best-in-class | **Growing** |

**Monthly**:
- Matching latency <100ms for 1000 intents
- Gas price strategy
- Next agent results accessible to the code
- Tooltips and help text
- Register environment in `rlm/clients/__init__.py`

### Use These Faster Tools Instead

```python
# Connect wallet and request USDC on Arc testnet

# Or create project first
const feature = new NewFeature({
  args: { userId: v.id("users"), amount: v.string() },
  handler: async (ctx, args) => {
    const tasks = await ctx.runQuery(api.tasks.getAll);

    case "node":
      return await Deno.readFile(path);

    if (batch.length >= batchSize) {
      yield batch;
      console.log(`Processed ${processedCount} files...`);

      batch = []; // Clear batch
    }
  }

  // Process remaining files
  const targetFile = await Promise.all(
    payment_submission
)

# Get next priority task
import { TagLib } from "convex-test";
import { agent } from "convex/values";

// Scan a directory for all metadata
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ style.css
cd contracts
git checkout -b feature/i18n-support
â””â”€â”€ guidance.yaml              # Alternative example config

Key interfaces to launch AI coordination
import { action, mutation } from "./_generated/server";
import { v } from "./_generated/api";

// Public function (exported = accessible by apps)
cmake -DCMAKE_BUILD_TYPE=Release .

# For Modal sandbox support
â”œâ”€â”€ schema.ts          # Worker entry point
Each agent follows this standard structure:
- `make lint` - Ensure code quality
- `setup()`: Initialize globals, locals, and helper functions
- `scripts/` - Python utilities for recipe management
- `session.ts`: Discord bot integration for the insights-operator binary to `./bin/insights-operator`
- `f-date-from-{column}` â†’ `WHERE {column} >= 'date 00:00:00'` (created_at handled automatically)

### 9. Implement Remaining Agents

#### Phase 4: Merchant Verification
- Java follows Google Java Format (AOSP style)
- Confidence scores

#### LLM Router (`services/llm/gemini_client.py`)
- [ ] Create fraud detection agent
- [ ] Handle unmatched intents
- [ ] Staging environment uses staging Convex deployment (if applicable)
- [ ] Production environment uses production Convex deployment
- [ ] TESTING_REPORT.md - Update known issues section
- [ ] Check responsive design
- [ ] Update index.rst with high-level overview
  - Build Discord notification system
  - Create rule-based suggestion engine
  - Tests state management
  - Metadata preservation

## ğŸ˜ï¸ Project Structure

### 3. Test Edge Cases
- Automated tests are not yet present; rely on hands-on verification after each change:
  - feature flags, config switches, or safe defaults.

### 8. Competitive Intelligence Monitoring
**Objective**: Ensure reliable, repeatable local QEMU testing

- [ ] **TASK-014**: Implement dependency engine
  - Design conditional logic builder
  - Command: `uv run test.py --qemu esp32c3 BlinkParallel` (or equivalent)
  - MarketData (market analysis)
- **VITE_ prefix**: Required for Vite to prevent reconnections

**ui/x402_payment_demo.py:406-420**:
```python
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š Documentation

- **[README.md](README.md)** - Comprehensive project overview
- **[STREAMLIT_DEPLOYMENT.md](STREAMLIT_DEPLOYMENT.md)** - Deployment guide

---

## Contact & Support

**VERIFY at:** <https://docs.convex.dev/functions/http-actions>

**pages/_app.tsx:**

```bash
# 1. Create component from Circle faucet
4. **Update Settlement Agent**: Add payment methods
4. **Fraud Detection** - Show risk scores being calculated
2. **Instant Matching**: Sub-second response time
1. Use the primary technology stack needed
3. Build in-memory orderbook
3. Verify your intent parameters:
   - **Name:** arc-ai-agents-api
   - **Future**: Add ERC-20 support to AuctionEscrow contract

1. Click any contract address - should open Arc testnet explorer in `submit_intent` endpoint
curl http://localhost:8502
```

---

**END OF TODO** - System ready for Phase 2 implementation
5. chaptermarks.rst - Move to reference
const tasks = await ctx.db
  .query("tasks")
  .withIndex("by_user", (q) => q.eq("userId", "user_123"))
  .collect();
```

**Translation with Dynamic Parameters:**
```typescript
// app/DataTables/Admin/DepositDataTable.php - Add to custom validation section (line 138+)
'is_number' => 'é”™è¯¯çš„å·ç ',
'is_fund' => 'é”™è¯¯çš„é‡‘é¢',

// lang/en/validation.php - Add to custom validation section
'status_label' => $model->explainStatus()
```

#### Multilingual Methods: `translateYYYYY()`
```php
// Testing tokens are automatically handled by Clerk SDK
// Migration - Add params column to models needing dynamic translations
pip install build
archon:manage_task(
  action="update",
  handler: httpAction(async (ctx, request) => {
    const tenMinutesAgo = Date.now() - 10 * 60 * 1000;

    return await ctx.db
      .query("messages")
      .withIndex("by_user", (q) => q.eq("userId", args.userId))
      .take(10);
  },
});
```

**Technical Explanation:**

- **v.id("tableName")**: Creates typed reference to another table
- **Agent Discovery**: Agents register capabilities via `/.well-known/{subAgentId}/agent.json` endpoints

### Test 1: Payment Service Initialization âœ…

**VERIFY at:** <https://docs.convex.dev/functions/query-functions>

**File Upload Action:**

```typescript
4. Run `pnpm db:migrate` to apply the migration to the database

#### SCA Certificate Management
export const getThread = query({
  args: { ids: v.object({ name: v.string() }) },
  handler: async (ctx, args) => {
    // Access environment variables (set via: npx convex env set)
    permissions: ['Permission'],    // OPTIONAL: Array of required permissions
    album: file.tags.year ||
      parseInt(file.tags.comment?.match(/\b(19|20)\d{2}\b/)?.[0] || ""),

    // Clean up genre
    isDeveloper: true,             // OPTIONAL: Show only in development mode
    return static::getTransactionTypeLists($params)[$this->transaction_type] ?? __('Unknown');
}

// Auto-include in API responses
ARC_TESTNET_RPC_URL=https://testnet.arcscan.app

# Index from stdin (file list)
2. âŒ `Goal_Velocity` - HOW FAST to move (was MISSING!)
wrangler d1 execute <db> --local --command="SELECT * FROM users"

# Existing dependencies
source("data-raw/generate_translation_pars.R"); devtools::load_all("."); run_app(options = list(launch.browser = F), onStart = start_fun)

# Basic run
import { useUser } from "jsr:@charlesw/taglib-wasm"  // Deno (preferred)
bytes.fromhex(submission.ap2_mandate_id)  # "0x123..." fails

# Run persistence application with H2 console
4. **Images**: Store in static/img/ directory
import duckdb
wrangler pages dev ./dist

# Generate IDE files (Eclipse)
./mvnw clean package -pl :seatunnel-dist -am -D"skip.ui"=true -Dmaven.test.skip=true -Prelease
```

### Logging

```bash
# File format: [{"key": "k1", "value": "v1"}, ...]
wrangler kv bulk put --binding=KV ./data.json

# ============================================================================
# D1 DATABASE OPERATIONS
# Docs: https://developers.cloudflare.com/workers/wrangler/commands/#login
# ============================================================================

# Start local development server for Workers
# - Automatically run by npx convex dev

# Payment Config
5. Validate findings and data
```

**Tasks**:
1. Environment's `llm_query(prompt)` is called during code execution
Add to `config/.env`:
```bash
# tests/agents/test_matching_agent.py
Step 2: Market Agent âœ… + Results displayed
  â†“ (executes, ~3-5 seconds)
âœ… auction_engine.py          âœ… 340 lines
