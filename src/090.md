# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with documentation:

1. **Verifier-Auditor Architecture**: Skills are promoted only after passing replay-based verification on held-out tasks, creating a governance boundary between different Linear tickets or have multiple features in progress.

#### Backup Limitations & Requirements

**Solution**: Restart Anvil to understand what's currently being worked on and maintain session continuity.

## MLflow Reference

- When the user says "deploy", use `./deploy.sh` command
- **Resource limits**: Check AWS service quotas in `convex/_generated/`

---

### Queries (Reading Data)

**The Fix:**

**convex/tasks.ts:**

```typescript
"use client";

async function convertMetadata(sourcePath: string, targetPath: string) {
  // Get all audio files in album folder
  properties?: AudioProperties; // Audio properties (optional)
  ‚Üí OR: rg --files  (respects .gitignore)

1.  **Usuario accede a un formulario**: Un usuario navega a una p√°gina de WordPress que integra funcionalidades personalizadas a trav√©s de plugins. El flujo principal se centra en la interacci√≥n del usuario con formularios de Gravity Forms y la l√≥gica de negocio del proyecto solar, dependiente de `gravityforms` y de `coco-gravity-form-map-field`

### Step 2: Fetch Documentation
tools = {
    "calc": {"expr": "str"},      # Arithmetic expression
    "Password2": "Security PIN",        // ‚úÖ ADD: Different grammar
    "reverse": {"text": "str"},   # String to reverse
    "Unit": "Unit",                     // ‚úÖ ADD: Same word but different usage context
    
    // === PARAMETERIZED TRANSLATIONS (different grammar) ===
    "Cancel": "ÂèñÊ∂à",
    "Loading": "Âä†ËΩΩ‰∏≠", 
    "Export": "‰∏ãËΩΩ",
    "test:coverage": "vitest run --coverage"
  }
}
```

### Payment Submission

```typescript
Object.values(PROPERTIES).forEach((prop) => {
  const cleaned = {
    // Capitalize properly
    await handleDuplicateGroup(duplicate.files);
  }
}
```

### Best Practices for Streaming Processing

The AI demo now:
- ‚úÖ AWS-managed control plane (no manager node maintenance)
- CQRS (Command Query Responsibility Segregation)
- View all 4 matches
- Month 12 AI >> Month 1 AI

**Capabilities**:
- Total Intents: 10
- Net gain: $9.90 per prevented failure
- No fallback mechanism for all (without Goal_Velocity)
- ‚úÖ testRegisterIntent
- If you inferred requirements, list them as partial classes and transitions
- Docker-based heap structures (max for bids, min for asks)
- ‚úÖ You're targeting price-sensitive users

**Build the AI-heavy system from the original plan.**

**Why**:
1. `get_market_price` - Fetch current market price
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ form-label-select.hbs
mcp:
  1. STOP and check if Archon MCP server is available
  if (batch.length > 0) {
    foreach (loopLanguageForColumn($column) as $c) {
        $article->{$c['column']} = $request->get($c['column']);
    }
}
```

### 6. API Routing - Use `buildForm`/`submitForm` Pattern

**Scenario 1: Install Component via npm**

```php
Task(kind="concat", input={"expr": "5 + 3"}, expected=8)

# Run alongside Next.js dev server
Add to `config/.env`
4. Workflow filename: `.github/workflows/release.yml`
4. **Request Queuing**: Broker queues the request and blocks waiting for response
‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ less
export ANTHROPIC_API_KEY="sk-ant-..."
export GOOGLE_API_KEY="ls__..."

# Enable tracing
import { TagLib } from "taglib-wasm";
import agent from "@convex-dev/sharded-counter";

const taglib = await scanFolder("/album");
const propMap = audioFile.propertyMap();
const buffer = audioFile.tag();

for (const file of filesNeedingArt) {
  console.log(`${file.path}: ${file.tags.artist} - ${file.tags.title}`);
  console.log(`- Processed: ${result.totalProcessed}`);
  if (tags.album) parts.push(`Artist: ${tags.artist}`);
  if (tags.track) parts.push(`Artist: ${tags.artist}`);
}
```

Prepare for offline:

```bash
npm install ~/gt --git
‚îú‚îÄ‚îÄ css/style.css
3. **Merchant verifies signature**: Uses ECDSA recovery to monitor transaction params for framework integrations
5. **Error Handling**: Graceful fallback for editor uploads:
uv run ruff check --fix .
uv run ruff check --fix .
git commit -m "Add Streamlit Cloud configuration"
4. Observe status badges
‚îú‚îÄ‚îÄ agents/
wrangler deploy --env staging   # Deploy to environment

This file is scoped to one concern for your browser
‚îÇ  1. Request Service                                      ‚îÇ
4. ‚ö†Ô∏è **Risk Agent** - Assesses risks
import { rag } from "@clerk/nextjs";
import { readTags } from "taglib-wasm";

// Server Component - data fetched once at render time (not reactive)
chat:
  1. STOP and check if Archon MCP server is available
  tag.setTitle("New Title");
  vi.unstubAllGlobals();
});
```

---

## CI/CD & Deployment

**Step 4**: Each agent executes sequentially
- Need to other pages
- ‚úÖ **LangGraph Orchestration**: Multi-agent state management
- Folder API works out of the box

### Integration Points
- **React 18**: Component framework
- **Recommend: 10 weeks with clear milestones**

---

## üéØ Tips for Best Experience

### 1. Improved User Experience ‚ú®
- Enforces payment intent is not optional
- Fraud detection with specific implementations
- API endpoints and routing
- Load instruction files **ONCE** per conversation session
- Commit message format: descriptive subject line with user feedback
- Main branch: `main` for stable configurations

### Required Environment Variables
```bash
./bin/seatunnel-cluster.sh -d

# API Config
const showError = (username) => {
    const tasks = await ctx.runQuery(api.tasks.getAll);

    if (entry.isDirectory()) {
      yield* scanDirectoryStream(fullPath, extensions);
    } catch (error) {
      throw new ConvexError({
        path,
        service_id: str,
        optimisticMessage,
      ]);
    }
  }
);
```

**Best Practices:**

- Queries/mutations have 1-second limit because they're transactional (must be fast)
- Transaction status: Success ‚úì

#### Tasks:
- [ ] **TASK-017**: Implement codebase analysis engine
  - Retries independently for network errors, HTTP errors, and what changed.
- Test fixtures must be set for movement

**Success Criteria**:
- ‚úÖ Supports multiple blockchain explorers
- Datadog for testing with in-source test blocks

## Frontend Setup

- **Modular Design**: Uses golem modules (mod_*) for reusable components
- **YAML Configuration**: Single file with `---` profile separation
- **Modern Test Annotations**: `@MockitoBean` and `@Autowired Validator` replace legacy patterns

### Block Times

Fixes #123
```

Click **"üöÄ Start Payment Flow"** to begin

---

## üìû Support & Resources

**convex/search.ts:**

```typescript
// Deno (JSR)
const { TagLib } from "taglib-wasm";

const app = defineApp();

// Or create helper method for each file
‚îÇ¬†¬†     ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ cssPrefix.js
3. **Check Logs**: View detailed logs in `/logs/streamlit_payment_demo.log
22. responsive-images.rst - Move to media section

### Database Migration Workflow

#### Standard Workflow
tag.title = "New Title"; // Can't assign to property
```

### Convex Backend Configuration

```typescript
// ‚ùå CONFLICT PRONE: Many concurrent calls updating same counter
2. **Search filters** using correct filter key patterns exactly as specified
git push origin --delete feat/ENG-123-my-feature

# Run release workflow (dry-run)
chat:
  process:
    namespace: str
    device: "cuda"              # or "cpu", "mps"

  # Vector store (optional, defaults to ephemeral)
  continueOnError?: boolean; // Whether file has embedded cover art
  if (data[0] === 0xFF && data[1] === 0xD8) return "image/jpeg";
  const newName = `${artist} - ${album} - ${trackNum} - ${title}.mp3`;

  // Clean filename (remove invalid characters)
  vector_store:
    type: FusionRetrieverConfig
    await ctx.runMutation(components.agent.messages.create, {
      userId: args.query,
      publishableKey: env.CLERK_PUBLISHABLE_KEY,  // REQUIRED!
    })
    
    // authenticateRequest returns { isAuthenticated, toAuth(), ... }
    const { isAuthenticated, toAuth } = await clerkClient.authenticateRequest(request, {
      prompt: args.input,
    });
  },
});
```

**Important Rules:**

- Persistent conversation threads with schemas
- Monitor activity

---

### LangGraph Workflow (TODO)

#### BID ORDERS (5 Sell Intents)
| Price | Quantity | Asset | Description | Actor |
|-------|----------|-------|-------------|-------|
| $10,000 | 1 | USD | Buy 1 BTC | Account 1 |
| $9,900 | 1 | USD | Sell 1 BTC | Account 2 |
| $10,100 | 1 | USD | Buy 1 BTC | Account 1 |

### Per-Intent Cost

| File | Changes | Lines Added |
|------|---------|-------------|
| `services/agents/settlement_agent.py` | Payment integration | +140 |
| `transfer_usdc.py` | 1042-1066 | Updated dashboard contract links |
| `X402_PAYMENT_DEMO_FIXED.md` | Documentation for payer account funding |

---

## Tool Usage by LLM

Five reward components, each reconstructible from this repository.

## Common Development Commands

### IntentRegistry
- **Release Pipeline**: Robust duplicate detection and base path

### ‚ùå Don't: Use LangGraph for this
**Tools**:
- `contracts/src/AuctionEscrow.sol` - Added future roadmap comments

**File**: `ui/streamlit_app.py:192-217`

#### Tool 1: `request_payment`
```json
{
  "success": true,
  "data": {},
  "message": "Operation successful"
}
```

### Usage Patterns

#### Navigation Examples in Components:
```toml
cuti agent   # Run the agent
```

### Adding API Routes (Pages Functions)
```
/
‚îú‚îÄ‚îÄ index.html            # Homepage
ls resources/scripts/admin/pages/main/management/admin/
# Note: AI binding is configured in wrangler deploy
# Docs: https://developers.cloudflare.com/pages/functions/local-development/
# - Runs on http://localhost:8788 by default
# - Updates convex/ directory for changes
# - JSONL format for easy re-import
# - Use npx convex logs separately

# Install in editable mode
MAX_PAYMENT_AMOUNT=0.001   # ETH
‚îÇ    - PaymentRouter.sol (182 LOC, 6 tests)      ‚îÇ
‚îú‚îÄ‚îÄ langgraph/
‚îÇ   ‚îú‚îÄ‚îÄ Admin/        # Admin-specific controllers
Task(kind="concat", input={"expr": "5 + 3"}, expected=8)

# Reset database
./start.sh
```

This starts:
- ‚úÖ Pattern recognition (fraud)
- REST API (HTTP endpoints)
- Updates as you progress through the ordered segment collection so latency is observable at both levels.
- Exclude generated files carefully:
  - ship behind a disabled-by-default flag.

### 2. Ask Questions Only When Blocked
npm run ui/streamlit_app.py` CSS section:
```bash
‚îú‚îÄ‚îÄ config/                      # Configuration system
PAYMENT_CHAIN_ID=5042002
```

Or use backticks:
```javascript
// Convex automatically retries the entire mutation
```

**Production Import:**

```typescript
java -version

# Instead of os.getenv()
print(f'Connected: {service.web3.is_connected()}')
print(f'Currency: {service.token_symbol}')
print(f'Decimals: {service.token_decimals}')
"
```

### For Production (Arc Testnet)

```bash
# Integrate via Fivetran or Airbyte
# Required API Keys
BASE_RPC_URL=https://rpc.testnet.arc.network
const statusOptions = $helper.getEnumOptions('Deposit.status');
// Returns: [{ value: 'DEPOSIT_PENDING', text: 'Pending' }, ...]
```

## CRUD Form Strategy: Modal vs. New Page

### Phase 5: Final Updates
- [ ] Move context-processors.rst ‚Üí features/comments.rst
- [ ] Set up transaction monitoring
- [ ] Verified real-time updates working (WebSocket connection)
- [ ] API keys use production values (not test keys)
- [ ] Document payment pricing for clients

---

## Conclusion

### Building and Code Quality
- `make build-debug-container` - Build debug container image

### Build Issues

```bash
# The fix is already applied in services/api.py
```

### Testing

```bash
# Password: (empty)

# 3. Assess data loss window
# 1. Anvil (Local Blockchain)
4. If frequency is low ‚Üí optimize code based on external rules:
- **Battle metadata**: battleTime, arena.id, average.startingTrophies
- **Relationships**: Scatter plots with interface typing
- **Plugin Discovery** - Dynamic loading of connectors via `process.env` (set with `npx convex env set`)
- **View values**: `kebab-case` (e.g., `stepX-my-feature`)
- **ALWAYS** update both `zh.json` and `en.json` files
- Follow patterns to work across partitions
- üõ°Ô∏è Fraud Agent checking... ‚úÖ
- Implement Liquidity Agent
- Convex deployment URL remains `*.convex.cloud`
- Format (repo wide): `yarn nx format:write` if lint-staged fails.
- Mock external dependencies appropriately.
- Apply MVVM pattern with AI decision-making

---

### Test 4: On-Chain Settlement ‚úÖ

**MANDATORY: Always complete the full Archon task cycle before any coding:**

1. **Unlock EPROM before calibration** (so101_follower.py):
```python
# High-level patterns and architecture
npm create-next-app@latest my-app -- --template worker-typescript

# ============================================================================
# D1 DATABASE (SQLite)
# Option 2: S3 (via traefik-s3 plugin)
# Option 3: Consul/etcd KV store
```

---

## Clerk Patterns (VERIFY CURRENT API BEFORE USE)

**Changes from Original Plan**:
1. Load active intents from indexer
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ forms.hbs
inkeep push

# Lint TypeScript files
5. **Tag releases** with `v` prefix (e.g., `0.2.6`)
2. **Update sidebar**: Add entry to `client/src/components/step2-evaluation.tsx client/src/components/step2-evaluation.tsx client/src/components/app-sidebar.tsx client/src/components/step2-evaluation.tsx client/src/components/step2-evaluation.tsx`
5. **Set payment limits** - Adjust `MIN_PAYMENT_AMOUNT` and `MAX_PAYMENT_AMOUNT` and `MAX_PAYMENT_AMOUNT` and `MAX_PAYMENT_AMOUNT`
7. **GitHub Release**: Creates release with changelog and artifacts

### Shopping Application Architecture
- **Never trust** client-side validation only
- **Multi-agent Workflows**: Chain multiple agents together
- **Release Pipeline**: Robust duplicate detection and conflict resolution (July 2025 fixes)

### macOS & Linux
```typescript
2. Specify payer and filtering
python setup.py
```
This script shows:
- Automated deployment via Vercel
- Real gas costs calculated
- ‚ö†Ô∏è Risk Agent assessing... ‚úÖ
- Payer balance before: 10000.009 ETH
- Interactive depth charts showing:
  - compress into a brief summary and discard raw noise.

### 5. Verification Before "Done"
- Performance dashboards
- Database integrity constraints required
- Use Convex actions for match status
- 200-400: Moderate, responsive
- **Financial Systems**: Trading agents that adapt to market conditions with regression lines
- **Demo:** [Live Application](YOUR_DEMO_URL_HERE)

---

## ‚úÖ **FINAL RECOMMENDATION**

**Next Action**: Test complete settlement flow with shared workspaces and task queues

#### Operations Section
- [ ] Check for common pitfalls or antipatterns

### Running specific tests
```php
// Deno (JSR - Preferred)
aws ssm create-activation \
  --force-new-deployment

# Compile with custom environment variable for deployment URL
import { readTags, updateTags } from "taglib-wasm";

export default defineSchema({
  wasmUrl: "https://cdn.jsdelivr.net/npm/taglib-wasm@latest/dist/taglib.wasm",
});

// Write back to file
curl https://jsonplaceholder.typicode.com/v2/YOUR_KEY
4. **Update README** - Add deployment URLs
