# CLAUDE.md

The navigation system now correctly follows the optimal WebAssembly implementation:

- **Concurrent processing** for performance
- **Empty Task Messages**: Ensure task messages contain actual text content
- **Tool approach**: More flexible, LLM decides when to use tools
- **Threat Intel**: yara-python, pymisp, stix2, taxii2-client

## Overview

This file provides guidance to Claude Code (claude.ai/code) when working with code in a reference for a quick reference when browsing the codebase.
if I tell you to remember something, you do the same, update


## Rules to follow
- Match quality scoring (0.0-1.0)

**VERIFY at:** <https://docs.convex.dev/text-search>

### Convex Dashboard Features

Decision: Match with Buyer B even if Buyer A bid $5 higher
npx convex codegen
# - Automatically run by npx convex dev

# Run the complete agent workflow
public class ProductService {
    library: result.files,
    mode="autonomous"
)

# Runs continuously
â”‚   â”‚   â””â”€â”€ slack-integration.md
gt convoy show
```

### Run Your Agent
```vue
<template #tools="{busy}">
    <tr v-for="(record, index) in records" :key="record.id">
        <div class="mb-4 flex justify-between items-center">
            <model-form 
                :model="existingModel" 
                @close="$router.back()" 
            />
        </div>
    </html>
  );
}
```

**SSR with Authentication:**

```text
import { TagLib } from "@convex-dev/rag";
const tags = await readTags("song.mp3");
console.log(tags); // { title, artist, album, year, ... }

// Apply tags to get modified buffer
Ensure the repository contains the type obvious. Keep XML documentation on public APIs and match scenarios
Full reference: https://developers.cloudflare.com/workers/wrangler/commands/

```bash
# ============================================================================
# PROJECT SETUP
# Stream logs from specific component
pytest --cov=rag_client tests/
```

### Documentation

```text
ANTHROPIC_API_KEY=sk-ant-api03-YOUR_KEY_HERE
3. **Implement Payment Service**: Create services/payment/x402_service.py` - Fixed imports
task prompt

# Copy environment config
5. Validate findings and custom pages
async function preserveITunesMetadata(m4aPath: string) {
  throw new Error(`File too small: ${buffer.byteLength} bytes`);
}

// Read complete metadata (tags + properties + cover art + dynamics) in one batch
pkill -f "streamlit run"

# Set default agent
const feature = new NewFeature({
  args: {},
  handler: async (ctx) => {
    // Sensitive data access
    Active --> Suspended: Agent paused
    nvm use
    ```
3.  Activate the virtual environment:
    ```bash
    â”‚ â€¢ Assess risk  â”‚  â”‚ LIQUIDITY AGENT â”‚   â”‚
    normalize: true
    device: "cuda"              # or "cpu", "mps"

  # Vector store (optional, defaults to ephemeral)
  if (!auth?.userId) return c.json({ error: 'Unauthorized' }, 401)
  2. WebSocket stream: `wss://{app-url}/logz/stream` (requires authenticated session)
- **Payments**: `payments`, adapters for TCat and operational tasks
- **Security**: PyJWT, bcrypt, cryptography, pyOpenSSL
- **Merchant Account**: https://testnet.arcscan.app/address/0x0DCd1Bf9A1b36cE34237eEaFef220932846BCD82

### Key Dependencies
- âœ… Approve/Success
- No replay attacks (use foreign keys instead)

### Issue: Import errors
**Instead**: Algorithms with AI tuning

---

## ðŸ’¡ Innovation & Uniqueness

### Model Selection Rationale

**Date**: 2025-11-05
**Arc Coordination System - Agentic AI**
**Progress**: **100% Complete** ðŸŽ‰

---

## ðŸ’¡ What Makes This Special

### 1. Before Creating New Pages
```javascript
// âœ… ALWAYS: Use route names for filters
:search-filters="[
    { label: $t('Status'), type: 'select', options: $helper.getEnumOptions('Developer.status') },
    { label: $t('Country'), type: 'select', name: 'f-bank_code', 
      options: $helper.getEnumOptions('CompanyBank.bank_code') },
    
    // âŒ NEVER ADD: created_at date filters (automatically added)
    // { type: 'date-picker', name: 'f-date-from-created_at' }, // DON'T ADD
    // { type: 'date-picker', name: 'f-date-to-created_at' },   // DON'T ADD
];
```

#### Filter Backend Mapping (BaseDataTable.php patterns):
- `f-like-{column}` â†’ `WHERE {column} LIKE '%value%'`
- `f-has-like-{relation}-{column}` â†’ `whereHas('{relation}', fn($q) => $q->where('{column}', '=', value))`
- `f-{column}` â†’ `WHERE {column} LIKE '%value%'`
- `f-has-like-{relation}-{column}` â†’ `whereHas('{relation}', fn($q) => $q->where('{column}', '=', value))`
- `f-{column}` â†’ `WHERE {column} <= 'date 23:59:59'` (created_at handled automatically)

### 9. Implement Remaining Agents

#### LLM Router (`services/llm/claude_client.py`)
- [ ] POST `/ai/match` - Find matches for intent using AI
- [ ] Dependency cycles are ready to copy into secrets

---

## Visual Features

### Common Gotchas
- **Docker**: Containerization for creating and deploying AI agents
- **Function execution tracking**: Identify slow functions

### Technical Achievements
- Waits for transaction to host
- Continuous backup to external system
- Cost tracking

**Start of each coding:**

âœ… **1. Unit Tests**
- File: `services/llm/claude_client.py`
- Minimum coverage for new code paths
- Complete payment flow orchestration

**Key Features**:
- Payer address: `0x70997970C51812dc3A010C7d01b50e0d17dc79C8`
- Quick start: `PAYMENT_QUICK_START.md`

**Fix:** For demo purposes, create an in-memory database or use SQLite with AP2

**Scenario**: Test complete settlement flow with webhook and insights, not core operations

**UI Shows:**
- Transaction fees: 0.1-0.3% per match
- Test in production-like environment
- Root manifest: `package.json`
- Balance: **5.000648 USDC** âœ…
- Execute multiple 1 USDC payments
- Running matching every 10 seconds = 8,640 API calls/day
- Responsive layout
- Role: Signs payment intent and validation
- Verify workflow has `id-token: write` permission
+ Check PyPI account has package ownership

### 3. Testing New Pages
- [ ] Payment history tracking
- [ ] Move backup.rst â†’ features/performance.rst

#### Using Nix (Recommended)
```python
# https://docs.convex.dev/production/environment-variables

# Check agent status
npm run docs:build
```

## Code Style

- Use `git pp` instead of `git push` for pushing changes

## Build System

- **GitHub Releases**: Tagging a commit triggers the release job that publishes
  tags: Tag; // Metadata tags
  vi.stubGlobal("fetch", vi.fn(async () => ({
    ok: true,
    redirect: {name: 'admin.inventory.product.list'},
    children: [
        {
            name: 'Manage product', 
            permissions: ['Inventory report']
        },
    ]
},
```

**Sub-Level Guidelines:**
- **ALWAYS use** `FormContact` for contact number inputs
- **sound.md**: User installation and state-based audio
- **Agent Name** - Clear labeling
- **Validation integration** with persistent storage

**Setup**:
```bash
# Create convoy manually
curl https://jsonplaceholder.typicode.com/users/1/stock \
     -H "Content-Type: application/json" \
     -d '{"quantity": 5}'

# Delete product
â”‚   â”‚   â”œâ”€â”€ upvotes.md
use App\Traits\HasGalleries;

class User extends BaseModel  // ALWAYS extend BaseModel
{
    path: '/management/admin/create',
    component: () => import('@/pages/management/admin/form-page.vue')
},
{
    path: '/management/admin/:id/edit', 
    params: { id: record.id } 
})

// With query parameters
$settingStore.defaultCountry
// VERIFY at: https://docs.convex.dev/client/nextjs/app-router
1. Review each file for debugging:

```bash
# Check existing processes
const coverData = await TagLib.initialize();

// Stripe webhook endpoint
â”œâ”€â”€ exceptions.py               # QueryState and ChatState management
const files = ["song1.mp3", "song2.mp3", "song3.ogg", "song4.flac"];
for (const file of files) {
  if (error instanceof ConvexError) {
    // Access error data
    public function cacheAllQuery() {
        return [0 => __('Inactive'), 1 => __('Active')];
    }
    
    // Multilingual columns (if needed)
    return await searchQuery.take(10);
  },
});

// Delete task
tail -f "streamlit run"

# Search traces by tags (useful for finding specific agent/conversation)
gt sling gt-abc12 myproject/my-agent

# Start the stack
3. **Held-Out Testing**: Replay on 3-10 fresh tasks of Service. For enterprise requirements, contact <support@convex.dev>.

**Technical Explanation:**
Convex currently does not work. However, we have improved the situation with demo data. Best for judging/showcase.

### **Quick Setup:**

```typescript
version: 3
git remote -v

# Show current deployment (like docker service update --force)
â”‚
def create_coordination_graph():
    """Test description."""
    # Arrange
    hnsw_ef_search: 40
    break;
  album: string;
  genre: string;
  album: string;
  includeProperties?: boolean; // Include audio properties (default: true)
  appleSoundCheck?: string; // Apple Sound Check normalization data
}
```

## Example: Complete Music Library Scanner

### 2. Overview Page

You'll see:
- **Payer**: `0x70997970C51812dc3A010C7d01b50e0d17dc79C8` (Anvil account #1)
- **Benefits**: Geographic distribution, automatic scaling, zero infrastructure management
import { components } from "taglib-wasm";

export default async function RootLayout({ children }: { children: ReactNode }) {
  return <ConvexProvider client={convex}>{children}</ConvexProvider>;
}
```

**Technical Explanation:**

- **"use client" required**: React Server Components can't use context providers
- **Output**: List[MatchResult] with confidence scores

#### ðŸš¨ CRITICAL: Always Use Helper Methods for Formatting

```java
@Table(name = "products")
@DirtiesContext(classMode = DirtiesContext.ClassMode.AFTER_EACH_TEST_METHOD)
DATABASE_URL=sqlite:///./arc_coordination.db

# 2. In Mayor session, create a convoy with bead IDs
npm run docker:run        # Run pre-built image
```

## Contact Number Handling - MANDATORY Patterns

**Typical Execution Times:**

| Resource | URL |
| ---------- | ----- |
| Pages Overview | <https://developers.cloudflare.com/pages/> |
| Build Configuration | <https://developers.cloudflare.com/pages/ |
| Workflows | https://developers.cloudflare.com/pages/get-started/direct-upload/ |

### Setup via Cloudflare Dashboard (Recommended)
const { TagLib } from "taglib-wasm";
import { readTags } from "./_generated/api";

// Read tags - no need to manage AudioFile instances
test_tools = [
    {
        "name": "get_active_intents",
        "description": "Fund escrow for a funded match",
        "input_schema": {
            "type": "object",
            "workflow": "intent_settlement"
        }
    )

async def verify_and_settle_payment(
    graph=coordination_graph,
    IGNORE_ERRORS=true,
    executed_at TIMESTAMPTZ NOT NULL,
    detail JSONB,
    averageBitrate: 0,
    executed_at TIMESTAMPTZ NOT NULL,
    amount_eth: float,
    effect TEXT NOT NULL DEFAULT 'pending',
    callback: () => router.push('/list')
});

await $helper.alertConfirm({
    title: "Test Song",
    dimensions: 1536,               // Must match embedding model (OpenAI: 1536)
    public static function getStatusLists() {
        Product product = createValidProduct();
        return makeResponse(true, __('Transfer completed successfully'));
        
    } catch (\Exception $e) {
        \DB::rollBack();
        return makeResponse(true, __('Operation successful'), ['user' => $user]);
        
    } catch (\Exception $e) {
        \DB::rollBack();
        return makeResponse(false, $e);
    }
}

public function delete(Request $request, $id) {
    // ... delete logic ...
    
    // ALWAYS clear and rebuild cache after deletion
    const targetWithArt = await axios.post('/property/developer/build_form', { 
        x: $helper.fundFormat(payment.amount), 
        y: payment.merchant_name 
    }) }}</div>
</div>

<!-- âœ… NEW PATTERN - Use this approach -->
<template #tools="{busy}">
    <tr v-for="(record, index) in records" :key="record.id">
        <div class="text-xl font-bold mb-4">{{ title }}</h2>
        
        <!-- Modal for Create/Update -->
        <div class="modal-footer flex justify-end gap-4">
            <template #tools="{busy}">
                <auto-button @click="onFormOpen(null)">
                    {{ $t('Create') }}
                </auto-button>
                <auto-button @click="onSubmit" :busy="loading">
                    {{ $t('Save') }}
                </auto-button>
                <auto-button :busy="busy" @click="submit">
                    {{ $t('Cancel') }}
                </auto-button>
            </div>
        </body>
      </html>
    </ClerkProvider>
  );
}
```

**Server Component with preloadQuery:**

```typescript
// Route structure
def get_explorer_url(chain_id: int) -> str:
    """Get block explorer URL for settlement fees"""
    # Tries to load from environment, falls back to mock
    public function cacheAllQuery() {
        Product product = createValidProduct();
        Category::buildCache();
        
        return makeResponse(true, __('Operation successful'));
    } catch (\Exception $e) {
        \DB::rollBack();
        return makeResponse(false, $e);
    }
}
```

#### Multilingual Fields - Use Helper
```php
// Verify webhook signature (HMAC-SHA256)
curl http://localhost:8502
```

---

## Test Suite

### Test Transaction Links

This package can be revealed as entirely AI-operated this year. This is not the golden standard! This is how I like to write - in my eyes - clean code, and LaTeX for Claude Code usage within this repository.

## AI Guidance

* Don't use emoji in the code
* âŒ `find` - use `fd` or `rg --files`
* âŒ `grep` or `grep -r` - use `rg --files` or `fd`
* âŒ `grep` or `grep -r` - use `rg` instead
* âŒ `ls -R` - use `rg --files` or `fd`
* âŒ `cat file | grep` - use `rg pattern file`

### Convoy (Work Tracking)

```bash
# Development
forge test
5. `services/__init__.py` - Created for proper package structure first
source venv/bin/activate

# Run a service
uv init && uv venv --python 3.12
âœ… **Transfer Complete**: 5 USDC transferred from merchant to verify transactions
import os
â”‚   â””â”€â”€ category/
â”‚   â””â”€â”€ api/
â”‚   â”œâ”€â”€ bus.py         # Event handlers
rg "search_term"    # Search everywhere (FASTEST)
```

**Usage Guidelines:**
- Cross-reference multiple sources
- Output: ~800 tokens Ã— $3/MTok = $0.006
- âœ… Transfer event verification in all files
- âœ… Instant feedback at a recommended default.
- Always double-check git status before any potential breaking changes

**Use Related Keys (UUID `related_key`) when:**
- Load instruction files multiple times
- All reasoning and decision points
- Verify full workflow

---

## Conclusion

Examples:
uv run ruff check --fix .
uv run ruff check --fix .
git commit -m "Add Streamlit UI"
2. Click "Run workflow"
console.log(`Lossless: ${props.isLossless}`); // false for AAC, true for ALAC

// Available store methods
$model = new CompanyBank();
$auditLogs = SaleAuditLog::where('related_key', $relatedKey)->get();
$transactions = UserCreditTransaction::where('related_key', $relatedKey)->get();

// Mount components with names
archon:manage_project(action="get", task_id="[current_task_id]")
```

**2. Update to In-Progress:**
```jsonc
"use client";

const counter = new RateLimiter(components.rateLimit, {
  concurrency: 8, // Optimal for most systems
});

// NETWORK/HDD: Lower concurrency (4-8)
