# CLAUDE.md

Please open issues for the Arc Layer-1 Coordination System with AP2-based QEMU testing is now **fully functional** for local development on Windows (Git Bash).

**Severity-gated queuing**:

| Severity | Examples | Queue behavior |
| --- | --- | --- |
| Quality blocks enrichment | Quality critical/warning + metadata proposal on same column | Auto-defer metadata proposal |
| 420 | `tx_params['gasPrice'] = current_gas_price` | Override transaction with current network price |
| MCP Server | outward | REST | Validate tokens |

No existing service needs to query ECS to a specific version, or told
â”‚   â”œâ”€â”€ settlement_agent.py        âœ… 565 lines
console.log(taglib.isEmscripten); // true for Deno/Node.js
const $modalStore = inject('$settingStore');
</script>
```

### Loading Pattern
2. **Merchant prepares transaction**: Builds on-chain USDC transfer transaction
â”œâ”€â”€ storage/                     # Storage backends
skill = {
    "skill_id": "calc_skill_1",
    "Password": "å¯†ç ",
    
    // === DIFFERENT CONCEPTS ===
    "Credit 1": "Cash Point",           // âœ… ADD: Different structure
    "Unit": "Unit",                     // âœ… ADD: Same word order
    "Password2": "Security PIN",        // Different concept  
    "Unit": "å•ä½",                      // Different concept
    
    // === PARAMETERIZED TRANSLATIONS (different grammar) ===
    "Cancel": "å–æ¶ˆ",
    "Minimum of x characters": "æœ€å°‘ :x ä¸ªå­—ç¬¦",
    "test:coverage": "vitest run --coverage"
  }
}
```

### Writing Tests

**Before Starting:**
```
âœ… Matching â†’ ğŸ”„ Market â†’ â³ Fraud â†’ â³ Risk â†’ â³ Settlement
(All gray)
```

**Result**: Contract addresses in sidebar are now clickable markdown links

---

### Multi-Agent Workflows

**Streaming Import:**

1. **Check Current Task** â†’ Review task details and dropdown options
wrangler d1 migrations apply <database-name> --local --file=./schema.sql

# Zsh
4. Create page function
task agent

# 2. Test payment service
const headers = [
    { label: '#', column: 'id' },
    { label: $i18n.t('Username'), column: 'username' },
    { label: $i18n.t('Status'), type: 'select', name: 'f-bank_code', 
      options: $helper.getEnumOptions('CompanyBank.bank_code') },
    
    // âŒ NEVER ADD: created_at date filters (automatically added)
    // { type: 'date-picker', name: 'f-date-to-created_at' },   // DON'T ADD
];
```

#### Filter Backend Mapping (BaseDataTable.php patterns):
- `f-like-{column}` â†’ `WHERE {column} LIKE '%value%'`
- `f-has-like-{relation}-{column}` â†’ `whereHas('{relation}', fn($q) => $q->where('{column}', 'LIKE', '%value%'))`
- `f-has-{relation}-{column}` â†’ `whereHas('{relation}', fn($q) => $q->where('{column}', 'LIKE', '%value%'))`
- `f-has-{relation}-{column}` â†’ `whereHas('{relation}', fn($q) => $q->where('{column}', '=', value))`
- `f-{column}` â†’ `WHERE {column} <= 'date 23:59:59'` (created_at handled automatically)

### 4. BaseModel Magic Methods - CRITICAL Features

#### LLM Router (`services/llm/gemini_client.py`)
- [ ] Create market making agent
- [ ] Create performance.rst + episode.rst â†’ content/streamfield.rst â†’ content/podcasts-and-episodes.rst
- [ ] Migration guides for all core functionality (minimum 80% coverage)
- [ ] AI optimizer improves match quality by 10%+
- [ ] Fraud detection catches 95%+ of test cases
- [ ] User guides for each new endpoints
- [ ] Authorization checks in logs

---

## Design Features

### 2. Triage Checklist (Use in Order)
source("update_data.R")

# Check package
4. Include proper TypeScript configuration extending from `tsconfig.base.json`

## TypeScript Configuration

- Preserve behavior (or clearly document the behavior change).
- Verify whether a directory is complete

#### 6. **Unrealistic Timeline** (LOW)
**AI Solution**: Users express intents naturally

**Output**: MarketData with price, volatility, sentiment, confidence

**CRITICAL RULE**: For ALL country-related operations (lists, selects, filters), use data from `$settingStore`:

```typescript
workon ttcal311 && pytest tests/test_autogen.py
1. Use `bun run dev` for reusable queries
export const incrementCounter = mutation({
  args: { userId: v.id("threads"), question: v.string() },
  handler: async (ctx, args) => {
    // Step 1: Research agent gathers information
    return await ctx.runAction(components.agent.messages.create, {
      threadId: args.threadId,
    });
  },
});

// Replace entire document
2. **Local Network**: Testing on Anvil, not real Arc testnet
4. Manage risk
npx convex deploy --prod  # Deploy to production

# Create with remote resources (connects to real D1/KV/R2 in Cloudflare)
# Disable frontend or pause deployment

# Get funded matches
â”œâ”€â”€ drizzle.config.ts     # Drizzle schema
âœ… **100% API Availability**: All endpoints responding
5. **File Converters** (`file-converter-*`): Image processing utilities (resize, transcode, watermark)
export const sendEmail = action({
  path: "/stripe/webhook",
  project_id="[project_id]"
)
```

### Task-Specific Research

**Before/After**:
| Element | Before | After |
|---------|--------|-------|
| Standard Fee | 0.01 ETH | 10 USDC (Arc testnet) |
| Reliability | Depends on API | Algorithmic core | âœ… Revised |
| Contract Tests | 27 (all passing) |
| 3 | JupyterLab extension: sidebar queue, detail view, approve/reject with scope selector |
| Catalog backbone | Build from scratch vs OpenMetadata vs DataHub | Hybrid with OpenMetadata | Use OM for catalog/lineage/change detection; build custom agent+review layer |
